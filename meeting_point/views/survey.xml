<odoo>
    <data noupdate="0">

        <record id="meeting_point_survey_kanban" model="ir.ui.view">
            <field name="name">meeting.point.survey.kanban</field>
            <field name="model">survey.survey</field>
            <field name="priority" eval="1"/>
            <field name="arch" type="xml">
               <kanban default_order="date">
                    <field name="stage_id"/>
                    <field name="designed"/>
                    <field name="title"/>
                    <field name="tot_sent_survey"/>
                    <field name="tot_start_survey"/>
                    <field name="tot_comp_survey"/>
                    <field name="color"/>
                    <field name="auth_required"/>
                    <field name="public_url"/>
                    <field name="my_status"/>
                    <templates>
                        <t t-name="kanban-box">
                            <div t-attf-class="survey_kanban_reocord oe_kanban_card oe_kanban_global_click oe_kanban_card oe_kanban_action" groups="meeting_point.group_meeting_admin">
                                <div class="kanban_del">
                                    <a type="delete" groups="meeting_point.group_meeting_admin">Delete</a>
                                </div>
                                <div class="oe_kanban_content" style="text-align: initial;">


                                    <h3 class="oe_center">
                                        <field name="title"/>
                                    </h3>

                                    <t t-if="record.meeting_id.raw_value">
                                        <span>Meeting :</span><field name="meeting_id"/>
                                    </t>
                                    <t t-if="!record.meeting_id.raw_value">
                                        <field name="meeting_id" invisible="1"/>
                                    </t>
                                    <div class="survey_kanban">
                                        <div>
                                        <t t-if="record.my_status.raw_value=='done' ">
                                            <h3 class="badge" style="float:right">Completed<i class="fa fa-check fa-lg" style="color:green"/></h3>
                                        </t>
                                        </div>
                                            <t t-if="! record.designed.raw_value">
                                                <button class="survey-button btn btn-primary  ml4" style="width: 100%" groups="meeting_point.group_meeting_admin">Test</button>
                                            </t>
                                            <t t-if="record.designed.raw_value">
                                                <t t-if="record.my_status.raw_value=='pending' ">
                                                    <button type="object" class="btn btn-primary ml4 btn-md acceptancebtn oe_center" style="width: 100%" name="action_start_survey"  attrs="{'invisible':[('stage_id', '=',3)]}">Start</button>
                                                </t>
                                            </t>


                                            <!--<button type="object" style="width: 100%" class="survey-button btn btn-primary ml4" name="action_send_survey" groups="meeting_point.group_meeting_admin">Share</button>-->


                                            <button class="survey-button btn btn-primary ml4" style="width: 100%" name="action_result_survey" type="object" groups="meeting_point.group_meeting_admin">View Results</button>

                                    </div>
                                </div>
                            </div>

                            <div t-attf-class="survey_kanban_reocord oe_kanban_card  oe_kanban_card oe_kanban_action" groups="!meeting_point.group_meeting_admin">
                                <div class="oe_kanban_content" style="text-align: initial;">
                                    <t t-if="record.my_status.raw_value=='done' ">
                                        <h3 class="badge" style="float:right">Completed<i class="fa fa-check fa-lg" style="color:green"/></h3>
                                    </t>
                                    <h1 class="oe_center">
                                        <field name="title"/>
                                    </h1>
                                    <t t-if="record.meeting_id.raw_value">
                                        <span>Meeting: </span><field name="meeting_id"/>
                                    </t>
                                    <t t-if="!record.meeting_id.raw_value">
                                        <field name="meeting_id" invisible="1"/>
                                    </t>
                                    <div>
                                        <div class="survey_kanban">

                                                <a name="action_test_survey" type="object" groups="meeting_point.group_meeting_admin">Design
                                                </a>
                                                <t t-if="record.designed.raw_value">
                                                    <t t-if="record.my_status.raw_value=='pending' ">
                                                        <button type="object" class="btn btn-primary ml4 btn-md acceptancebtn oe_center" style="    width: 100%" name="action_test_survey" groups="!meeting_point.group_meeting_admin" attrs="{'invisible':[('stage_id', '=',3)]}">Start
                                                        </button>
                                                    </t>
                                                </t>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>

            </field>
        </record>

        <record model="ir.ui.view" id="view_meeting_survey_tree">
            <field name="name">Meeting Surveys</field>
            <field name="model">survey.survey</field>
            <field name="priority" eval="1"/>
            <field name="arch" type="xml">
                <tree>
                    <field name="title" />
                    <field name="meeting_id" />
                </tree>
            </field>
        </record>

        <record model="ir.ui.view" id="survey_form_modified">
            <field name="name">Form view for survey modified</field>
            <field name="model">survey.survey</field>
            <field name="arch" type="xml">
                <form string="Survey">
                    <field name="id" invisible="1"/>
                    <field name="my_status" invisible="1"/>
                    <field name="tot_start_survey" invisible="1"/>
                    <field name="is_closed" invisible="1"/>
                    <header groups="survey.group_survey_manager">
                        <!--<button name="action_test_survey" string="Design Survey" type="object" class="oe_highlight"/>-->
                        <!--<button name="action_test_survey" string="Test Survey" type="object" attrs="{'invisible': [('my_status', '=', 'done')]}"/>-->
                        <button name="action_print_survey" string="Print Survey" type="object" attrs="{'invisible': [('id', '=', False)]}"/>
                        <button name="action_start_survey" string="Start Survey" type="object" attrs="{'invisible': [('my_status', '=', 'done')]}"/>
                        <!--<button name="action_send_survey" string="Share and invite by email" type="object" class="oe_highlight"  attrs="{'invisible': [('id', '=', False)]}"/>-->
                        <button name="action_result_survey" string="View results" type="object" class="oe_highlight" attrs="{'invisible': [('tot_start_survey', '=', 0)]}"/>
                        <field name="stage_id" widget="statusbar" clickable="True" />
                    </header>
                    <sheet>
                        <div class="oe_button_box" name="button_box">
                            <button name="action_survey_user_input"
                                type="object"
                                class="oe_stat_button"
                                icon="fa-pencil-square-o">
                                <field string="Answers" name="tot_comp_survey" widget="statinfo"/>
                            </button>
                            <button name="toggle_active" type="object" class="oe_stat_button" icon="fa-archive" attrs="{'invisible': [('is_closed', '=', False)]}">
                                <field name="active" widget="boolean_button" options='{"terminology": "archive"}'/>
                            </button>
                        </div>
                        <div class="oe_title" style="width: 100%;">
                            <label for="title" class="oe_edit_only"/>
                            <h1><field name="title" placeholder="Survey Title"/></h1>
                        </div>
                        <field name="audience" class="o_hidden"></field>
                          <div class="survey_meeting_id" attrs="{'invisible': [('audience', '=', 'partners')]}">
                            <h4>Meeting</h4>
                            <field name="meeting_id" options="{'no_quick_create': True, 'no_create_edit' : True}"  domain="['&amp;','&amp;','&amp;',('exectime','!=','completed'),('exectime','!=','archived'),('archived','=',False),('stop','>=', time.strftime('%Y-%m-%d'))]   " />
                        </div>
                           <div class="survey_respondents" attrs="{'invisible': [('meeting_id', '!=', False)]}">
                            <h4>Respondents</h4>
                            <field name="partner_ids" widget="many2many_tags" options="{'no_quick_create': True, 'no_create_edit' : True}"
                                   placeholder="Select respondents..." context="{'force_email':True}" class="oe_inline"/>
                        </div>
                        <notebook>
                            <page string="Edit Pages and Questions">
                                <field name="page_ids" mode="tree" context="{'default_survey_id': active_id}" nolabel="1">
                                    <tree>
                                        <field name="sequence" widget="handle"/>
                                        <field name="title"/>
                                        <field name="question_ids"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="Options">
                                <group class="o_label_nowrap">
                                    <field name="users_can_go_back" string="User can come back in the previous page"/>
                                    <field name="auth_required"/>
                                    <field name="quizz_mode" groups="base.group_no_one"/>
                                </group>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="activity_ids" widget="mail_activity"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

        <record id="action_survey_admin" model="ir.actions.act_window">
            <field name="name">Actions</field>
            <field name="res_model">survey.survey</field>
            <field name="view_mode">kanban,tree,form</field>
            <field name="view_id" ref="meeting_point_survey_kanban"/>
        </record>

        <record id="action_attendance_kanban_esurvey" model="ir.actions.act_window.view">
            <field name="act_window_id" ref="action_survey_admin"/>
            <field name="sequence" eval="1"/>
            <field name="view_mode">kanban</field>
            <field name="view_id" ref="meeting_point_survey_kanban"/>
        </record>

        <record id="action_attendance_form_survey" model="ir.actions.act_window.view">
            <field name="act_window_id" ref="action_survey_admin"/>
            <field name="sequence" eval="3"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="survey_form_modified"/>
        </record>

        <record id="action_survey_question_dev" model="ir.actions.act_window">
            <field name="name">Survey Questions</field>
            <field name="res_model">survey.question</field>
            <field name="view_mode">tree,form</field>
        </record>

        <record id="action_survey_user_input_dev" model="ir.actions.act_window">
            <field name="name">Survey Question Types</field>
            <field name="res_model">survey.user_input</field>
            <field name="view_mode">tree,form</field>
        </record>

        <record id="action_survey_answer_dev" model="ir.actions.act_window">
            <field name="name">Survey Answers</field>
            <field name="res_model">survey.user_input_line</field>
            <field name="view_mode">tree,form</field>
        </record>


        <template id="remove header" name="header button" inherit_id="website.layout">
            <xpath expr="//header//ul[@id='top_menu']/li[hasclass('dropdown')]" position="replace">
                <div class="survey_back_btn_container">
                </div>
            </xpath>
            <xpath expr="//header" position="replace">
                <a href="/" class="o_hidden">
                </a>
            </xpath>
        </template>

        <template id="survey_back_container" name="survey back container custom">
            <div class="navbar navbar-default navbar-static-top">
                <div class="container">
                    <div class="navbar-header">
                        <link rel="stylesheet" href="/meeting_point/static/css/survey_front.css" />
                        <script src="/meeting_point/static/js/survey_front.js"></script>
                        <div class="survey_back_btn_container">
                            <div t-if="survey.meeting_id" t-ignore="true" class="pull-right">
                                <a t-attf-href="/web#view_type=form&amp;model=calendar.event&amp;id=#{survey.meeting_id.id}&amp;action=meeting_point.action_upcoming_meeting" class="btn btn-default">Back to meeting</a>
                            </div>
                            <div  t-ignore="true" class="pull-right">
                                <a t-attf-href="/web#view_type=form&amp;model=meeting_point.news&amp;id=1&amp;action=meeting_point.action_news_user_home" class="btn btn-default">Back to Home Page</a>
                            </div>
                            <div groups="meeting_point.group_meeting_admin" t-ignore="true" class="pull-right">
                                <a t-attf-href="/web#view_type=form&amp;model=survey.survey&amp;id=#{survey.id}&amp;action=meeting_point.action_survey_admin" class="btn btn-default">Back to Survey</a>
                            </div>
                        </div>
                  </div>
                </div>
            </div>
        </template>



        <template id="survey.page" name="Survey Page Custom">
            <div class="page-header">
                <p class="pull-right">Page <span t-raw='page_nr + 1'/> of <span t-raw="len(survey.page_ids)"/></p>
                <h1 t-field='page.title' />
                <div t-field='page.description' class="oe_no_empty"/>
            </div>

            <form role="form" method="post" class="js_surveyform"
                  t-att-name="'%s_%s' % (survey.id, page.id)"
                  t-att-action="'%s/survey/fill/%s/%s' % (survey.base_url, slug(survey), token)"
                  t-att-data-prefill="'%s/survey/prefill/%s/%s/%s' % (survey.base_url, slug(survey), token, slug(page))"
                  t-att-data-validate="'%s/survey/validate/%s' % (survey.base_url, slug(survey))"
                  t-att-data-submit="'%s/survey/submit/%s' % (survey.base_url, slug(survey))">
                <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                <input type="hidden" name="page_id" t-att-value="page.id" />
                <input type="hidden" name="token" t-att-value="token" />
                <t t-foreach='page.question_ids' t-as='question'>
                    <t t-set="prefix" t-value="'%s_%s_%s' % (survey.id, page.id, question.id)" />
                    <div class="js_question-wrapper" t-att-id="prefix">
                        <h2>
                            <span t-field='question.question' />
                            <span t-if="question.constr_mandatory" class="text-danger">*</span>
                        </h2>
                        <div t-field='question.description' class="text-muted oe_no_empty"/>
                        <t t-if="question.type == 'free_text'"><t t-call="survey.free_text"/></t>
                        <t t-if="question.type == 'textbox'"><t t-call="survey.textbox"/></t>
                        <t t-if="question.type == 'numerical_box'"><t t-call="survey.numerical_box"/></t>
                        <t t-if="question.type == 'date'"><t t-call="survey.date"/></t>
                        <t t-if="question.type == 'simple_choice'"><t t-call="survey.simple_choice"/></t>
                        <t t-if="question.type == 'multiple_choice'"><t t-call="survey.multiple_choice"/></t>
                        <t t-if="question.type == 'matrix'"><t t-call="survey.matrix"/></t>
                        <div class="js_errzone alert alert-danger" style="display:none;"></div>
                    </div>
                </t>
                <div class="text-center mt16 mb16">
                    <button t-if="survey.users_can_go_back and page_nr > 0" type="submit" class="btn btn-default" name="button_submit" value="previous">Previous page</button>
                    <button t-if="not last" type="submit" class="btn btn-primary ml4" name="button_submit" value="next">Next page</button>
                    <button t-if="last" type="submit" class="btn btn-primary ml4" name="button_submit" value="finish">Submit</button>
                </div>
            </form>

            <!-- Modal used to display error message, i.c.o. ajax error -->
            <div class="modal fade" id="AJAXErrorModal" role="dialog" aria-labelledby="AJAXErrorModal" aria-hidden="true" >
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&amp;times;</button>
                            <h4 class="modal-title">A problem has occured</h4>
                        </div>
                        <div class="modal-body"><p>Something went wrong while contacting survey server. <strong class="text-danger">Your answers have probably not been recorded.</strong> Try refreshing.</p></div>
                        <div class="modal-footer"><button type="button" class="btn btn-primary ml4" data-dismiss="modal">Close</button></div>
                    </div>
                </div>
            </div>
        </template>

        <record id="email_template_survey_modified" model="mail.template">
            <field name="name">Survey Template MeetingPoint</field>
            <field name="model_id" ref="model_survey_survey" />
            <field name="auto_delete" eval="True" />
            <field name="body_html">
                <![CDATA[
<p>Hello,</p>
<p>We are conducting a survey, and your response would be appreciated.</p>
<p><a style="margin-left: 85px; padding:5px 10px; border-radius: 3px; background-color:#875A7B; text-align:center; text-decoration:none; color:#F7FBFD;" href="__URL__">Please, click here to start survey</a></p>
<p>Thanks for your participation!</p>
                ]]>
            </field>
        </record>
    </data>
</odoo>