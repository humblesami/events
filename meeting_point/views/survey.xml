<odoo>
    <data>

        <record id="meeting_point_survey_kanban" model="ir.ui.view">
            <field name="name">meeting.point.survey.kanban</field>
            <field name="model">survey.survey</field>
            <field name="priority" eval="1"/>
            <field name="arch" type="xml">
               <kanban default_order="date">
                    <field name="stage_id"/>
                    <field name="designed"/>
                    <field name="title"/>
                    <field name="tot_sent_survey"/>
                    <field name="tot_start_survey"/>
                    <field name="tot_comp_survey"/>
                    <field name="color"/>
                    <field name="auth_required"/>
                    <field name="public_url"/>
                    <field name="my_status"/>
                    <templates>
                        <t t-name="kanban-box">
                            <div t-attf-class="survey_kanban_reocord oe_kanban_card oe_kanban_global_click oe_kanban_card oe_kanban_action" groups="meeting_point.group_meeting_admin">
                                <div class="seen_by_me">
                                    <field name="seen_by_me"/>
                                </div>
                                <div class="kanban_del">
                                    <a type="delete" groups="meeting_point.group_meeting_admin">Delete</a>
                                </div>
                                <div class="oe_kanban_content" style="text-align: initial;">


                                    <h1 class="oe_center">
                                        <field name="title"/>
                                    </h1>

                                    <t t-if="record.meeting_id.raw_value">
                                        <span>Meeting :</span><field name="meeting_id"/>
                                    </t>
                                    <t t-if="!record.meeting_id.raw_value">
                                        <field name="meeting_id" invisible="1"/>
                                    </t>
                                    <div>
                                        <t t-if="record.my_status.raw_value=='done' ">
                                            <h3 class="badge" style="float:right">Completed<i class="fa fa-check fa-lg" style="color:green"/></h3>
                                        </t>
                                    </div>
                                    <div class="survey_kanban">

                                            <t t-if="! record.designed.raw_value">
                                                <button class="survey-button btn btn-primary  ml4" style="width: 100%" groups="meeting_point.group_meeting_admin">Test</button>
                                            </t>
                                            <t t-if="record.designed.raw_value">
                                                <t t-if="record.my_status.raw_value=='pending' ">
                                                    <button type="object" class="btn btn-primary ml4 btn-md acceptancebtn oe_center" style="width: 100%" name="action_test_survey" groups="meeting_point.group_meeting_admin" attrs="{'invisible':[('stage_id', '=',3)]}">Start</button>
                                                </t>
                                            </t>


                                            <button type="object" style="width: 100%" class="survey-button btn btn-primary ml4" name="action_send_survey" groups="meeting_point.group_meeting_admin">Share</button>


                                            <button class="survey-button btn btn-primary ml4" style="width: 100%" name="action_result_survey" type="object" groups="meeting_point.group_meeting_admin">Analyze</button>

                                    </div>
                                </div>
                            </div>

                            <div t-attf-class="survey_kanban_reocord oe_kanban_card  oe_kanban_card oe_kanban_action" groups="!meeting_point.group_meeting_admin">
                                <div class="oe_kanban_content" style="text-align: initial;">
                                    <div class="seen_by_me">
                                        <field name="seen_by_me"/>
                                    </div>
                                    <t t-if="record.my_status.raw_value=='done' ">
                                        <h3 class="badge" style="float:right">Completed<i class="fa fa-check fa-lg" style="color:green"/></h3>
                                    </t>
                                    <h1 class="oe_center">
                                        <field name="title"/>
                                    </h1>
                                    <t t-if="record.meeting_id.raw_value">
                                        <span>Meeting: </span><field name="meeting_id"/>
                                    </t>
                                    <t t-if="!record.meeting_id.raw_value">
                                        <field name="meeting_id" invisible="1"/>
                                    </t>
                                    <div>
                                        <div class="survey_kanban">

                                                <a name="action_test_survey" type="object" groups="meeting_point.group_meeting_admin">Design
                                                </a>
                                                <t t-if="record.designed.raw_value">
                                                    <t t-if="record.my_status.raw_value=='pending' ">
                                                        <button type="object" class="btn btn-primary ml4 btn-md acceptancebtn oe_center" style="    width: 100%" name="action_test_survey" groups="!meeting_point.group_meeting_admin" attrs="{'invisible':[('stage_id', '=',3)]}">Start
                                                        </button>
                                                    </t>
                                                </t>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>

            </field>
        </record>

        <record model="ir.ui.view" id="view_meeting_survey_tree">
            <field name="name">Meeting Surveys</field>
            <field name="model">survey.survey</field>
            <field name="priority" eval="1"/>
            <field name="arch" type="xml">
                <tree>
                    <field name="title" />
                    <field name="meeting_id" />
                </tree>
            </field>
        </record>

        <record id="meeting_point_survey_form" model="ir.ui.view">
            <field name="name">meeting.point.survey.form</field>
            <field name="model">survey.survey</field>
            <field name="priority" eval="1"/>
            <field name="arch" type="xml">
                <form string="Survey">
                    <link rel="stylesheet" href="/meeting_point/static/css/survey.css"/>
                    <field name="id" class="survey_id o_hidden"/>
                    <field name="seen_by_me" class="survey_seen o_hidden"/>
                    <field name="tot_start_survey" invisible="1"/>
                    <field name="is_closed" invisible="1"/>
                    <div class="container">
                        <div class="row">
                            <header groups="meeting_point.group_meeting_admin">
                                <button name="action_test_survey" string="Design Survey" type="object" class="oe_highlight" invisible="1"/>
                                <button name="action_test_survey" string="Test Survey" type="object" attrs="{'invisible': [('id', '=', False)]}"/>
                                <!--<button name="action_print_survey" string="Print Survey" type="object" attrs="{'invisible': [('id', '=', False)]}"/>-->
                                <!--<button name="action_send_survey" string="Share and invite by email" type="object" class="oe_highlight" attrs="{'invisible': [('id', '=', False)]}"/>-->
                                <button name="action_result_survey" string="View results" type="object" attrs="{'invisible': ['|',('id', '=', False), ('tot_start_survey', '!=', 0)]}"/>
                                <button name="action_result_survey" string="View results" type="object" class="oe_highlight" attrs="{'invisible': [('tot_start_survey', '=', 0)]}"/>
                                <field name="stage_id" widget="statusbar" clickable="True"/>
                            </header>
                        </div>
                    </div>

                    <sheet>
                        <div class="oe_button_box" name="button_box">
                            <button name="toggle_active" type="object" class="oe_stat_button" icon="fa-archive" attrs="{'invisible': [('is_closed', '=', False)]}">
                                <field name="active" widget="boolean_button" options="{&quot;terminology&quot;: &quot;archive&quot;}"/>
                            </button>
                            <button name="action_survey_user_input" type="object" class="oe_stat_button" icon="fa-pencil-square-o">
                                <field string="Answers" name="tot_comp_survey" widget="statinfo"/>
                            </button>
                        </div>

                        <h4>Survey Title</h4>
                        <field name="title" placeholder="Title"/>

                        <h4>Survey Type</h4>
                        <field name="survey_type" class="survey_type"/>

                        <field name="audience" class="o_hidden"></field>

                        <div class="survey_meeting_id" attrs="{'invisible': [('audience', '=', 'partners')]}">
                            <h4>Meeting</h4>
                            <field name="meeting_id" domain="[('publish','!=',False)]" />
                        </div>

                        <div class="survey_respondents" attrs="{'invisible': [('meeting_id', '!=', False)]}">
                            <h4>Respondents</h4>
                            <field name="partner_ids" widget="many2many_tags" options="{'no_quick_create': True, 'no_create_edit' : True}"
                                   placeholder="Select respondents..." context="{'force_email':True}" class="oe_inline"/>
                        </div>

                        <notebook class="survey_questions">
                            <page string="Edit Questions">
                                <field name="question_ids" mode="tree" nolabel="1">
                                    <tree>
                                        <field name="sequence" widget="handle"/>
                                        <field name="question"/>
                                        <field name="type"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="Options" invisible="1">
                                <group class="o_label_nowrap">
                                    <field name="users_can_go_back" string="User can come back in the previous page"/>
                                    <field name="auth_required"/>
                                    <field name="quizz_mode" groups="base.group_no_one"/>
                                </group>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                    <script src="/meeting_point/static/js/survey_common.js"/>
                    <script src="/meeting_point/static/js/survey.js"/>
                </form>
            </field>
        </record>

        <record model="ir.ui.view" id="survey_question_form">
            <field name="name">Form view for survey question</field>
            <field name="model">survey.question</field>
            <field name="priority" eval="1"/>
            <field name="arch" type="xml">
                <form string="Survey Question" create="false">
                    <style>
                        .modal .o_form_sheet .o_group
                        {
                        display:none;
                        }
                    </style>
                    <sheet>
                        <div class="oe_title" style="width: 100%;">
                            <label for="question" string="Question name" class="oe_edit_only"/>
                            <h1><field name="question" colspan="4" placeholder="Question Name"/></h1>
                            <separator />
                        </div>
                        <group>
                            <group>
                                <field name="type" widget="radio" />
                            </group>
                            <group>
                                <div class="col-md-6 col-md-offset-3 o_preview_questions">
                                    <!-- Multiple Lines Text Zone -->
                                    <div attrs="{'invisible': [('type', '!=', 'free_text')]}">
                                        <i class="fa fa-align-justify fa-4x"/>
                                    </div>
                                    <!-- Single Line Text Zone -->
                                    <div attrs="{'invisible': [('type', '!=', 'textbox')]}">
                                        <i class="fa fa-minus fa-4x"/>
                                    </div>
                                    <!-- Numerical Value -->
                                    <div attrs="{'invisible': [('type', '!=', 'numerical_box')]}">
                                        <i class="fa fa-2x">123..</i>
                                    </div>
                                    <!-- Date and Time -->
                                    <div attrs="{'invisible': [('type', '!=', 'datetime')]}">
                                        <p class="o_datetime">YYYY-MM-DD hh:mm:ss
                                            <i class="fa fa-calendar fa-2x"/>
                                        </p>
                                    </div>
                                    <!-- Multiple choice: only one answer -->
                                    <div attrs="{'invisible': [('type', '!=', 'simple_choice')]}">
                                        <div class="row"><i class="fa fa-circle-o  fa-lg"/> answer</div>
                                        <div class="row"><i class="fa fa-dot-circle-o fa-lg"/> answer</div>
                                        <div class="row"><i class="fa fa-circle-o  fa-lg"/> answer</div>
                                    </div>
                                    <!-- Multiple choice: multiple answers allowed -->
                                    <div attrs="{'invisible': [('type', '!=', 'multiple_choice')]}">
                                        <div class="row"><i class="fa fa-square-o fa-lg"/> answer</div>
                                        <div class="row"><i class="fa fa-check-square-o fa-lg"/> answer</div>
                                        <div class="row"><i class="fa fa-square-o fa-lg"/> answer</div>
                                    </div>
                                    <!-- Matrix -->
                                    <div attrs="{'invisible': [('type', '!=', 'matrix')]}">
                                        <div class="row o_matrix_head">
                                            <div class="col-md-3"></div>
                                            <div class="col-md-3">ans</div>
                                            <div class="col-md-3">ans</div>
                                            <div class="col-md-3">ans</div>
                                        </div>
                                        <div class="row o_matrix_row">
                                            <div class="col-md-3">Row1</div>
                                            <div class="col-md-3"><i class="fa fa-circle-o fa-lg"/></div>
                                            <div class="col-md-3"><i class="fa fa-dot-circle-o fa-lg"/></div>
                                            <div class="col-md-3"><i class="fa fa-circle-o fa-lg"/></div>
                                        </div>
                                        <div class="row o_matrix_row">
                                            <div class="col-md-3">Row2</div>
                                            <div class="col-md-3"><i class="fa fa-circle-o fa-lg"/></div>
                                            <div class="col-md-3"><i class="fa fa-circle-o fa-lg"/></div>
                                            <div class="col-md-3"><i class="fa fa-dot-circle-o fa-lg"/></div>
                                        </div>
                                        <div class="row o_matrix_row">
                                            <div class="col-md-3">Row3</div>
                                            <div class="col-md-3"><i class="fa fa-dot-circle-o fa-lg"/></div>
                                            <div class="col-md-3"><i class="fa fa-circle-o fa-lg"/></div>
                                            <div class="col-md-3"><i class="fa fa-circle-o fa-lg"/></div>
                                        </div>
                                    </div>
                                </div>
                            </group>
                        </group>
                        <notebook>
                            <page string="Valid Answers">
                                <field name="validation_email" attrs="{'invisible': [('type', '!=', 'textbox')]}"/>
                                <label for="validation_email" attrs="{'invisible': [('type', '!=', 'textbox')]}"/>
                                <separator />
                                <field name="labels_ids" string="Type of answers" context="{'default_question_id': active_id}" attrs="{'invisible': [('type', 'not in', ['simple_choice', 'multiple_choice', 'matrix'])]}">
                                    <tree editable="bottom">
                                        <field name="sequence" widget="handle"/>
                                        <field name="value" string="Choices"/>
                                    </tree>
                                </field>
                                <separator />
                                <label for="labels_ids_2" attrs="{'invisible': [('type', '!=', 'matrix')]}" />
                                <field name="labels_ids_2" context="{'default_question_id_2': active_id}" attrs="{'invisible': [('type', '!=', 'matrix')]}">
                                    <tree editable="bottom">
                                        <field name="sequence" widget="handle"/>
                                        <field name="value" string="Rows"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="Options" invisible="1">
                                <group string="Constraints">
                                    <group colspan="2" col="4">
                                        <field name="constr_mandatory" string="Mandatory Answer"/>
                                        <field name="constr_error_msg" attrs="{'invisible': [('constr_mandatory', '=', False)]}"/>
                                    </group>
                                    <div colspan="2" attrs="{'invisible': [('type', 'not in', ['textbox', 'numerical_box', 'datetime'])]}">
                                        <group>
                                            <field name="validation_required" attrs="{'invisible': [('validation_email', '=', True), ('type', '=', 'textbox')]}"/>
                                        </group>
                                        <group col="4" attrs="{'invisible': [('validation_required', '=', False)]}">
                                            <field name="validation_length_min" attrs="{'invisible': [('type', '!=', 'textbox')]}"/>
                                            <field name="validation_length_max" attrs="{'invisible': [('type', '!=', 'textbox')]}"/>
                                            <field name="validation_min_float_value" attrs="{'invisible': [('type', '!=', 'numerical_box')]}"/>
                                            <field name="validation_max_float_value" attrs="{'invisible': [('type', '!=', 'numerical_box')]}"/>
                                            <field name="validation_min_date" attrs="{'invisible': [('type', '!=', 'datetime')]}"/>
                                            <field name="validation_max_date" attrs="{'invisible': [('type', '!=', 'datetime')]}"/>
                                            <field name="validation_error_msg" colspan="4"/>
                                        </group>
                                    </div>
                                    <group>
                                        <field name="matrix_subtype" attrs="{'invisible':[('type','not in',['matrix'])]}"/>
                                    </group>
                                </group>
                                <group string="Display mode" attrs="{'invisible':[('type','not in',['simple_choice', 'multiple_choice'])]}">
                                    <field name="display_mode" string="Format" attrs="{'invisible':[('type','not in',['simple_choice'])],'required':[('type','=','simple_choice')]}"/>
                                    <field name="column_nb" string="Number of columns" attrs="{'invisible':[('display_mode','=','dropdown'), ('type','=','simple_choice')]}"/>
                                </group>
                                <group string="Allow Comments" attrs="{'invisible':[('type','not in',['simple_choice','multiple_choice', 'matrix'])]}">
                                    <field name='comments_allowed' />
                                    <field name='comments_message' attrs="{'invisible': [('comments_allowed', '=', False)]}"/>
                                    <field name='comment_count_as_answer' attrs="{'invisible': ['|', ('comments_allowed', '=', False), ('type', 'in', ['matrix'])]}" />
                                </group>
                            </page>
                        </notebook>
                    </sheet>
                    <script src="/meeting_point/static/js/survey_question.js"></script>
                </form>
            </field>
        </record>

        <record id="action_survey_admin" model="ir.actions.act_window">
            <field name="name">Actions</field>
            <field name="res_model">survey.survey</field>
            <field name="view_mode">kanban,tree,form</field>
            <field name="view_id" ref="meeting_point_survey_kanban"/>
        </record>

        <record id="action_survey_question_dev" model="ir.actions.act_window">
            <field name="name">Survey Questions</field>
            <field name="res_model">survey.question</field>
            <field name="view_mode">tree,form</field>
        </record>

        <record id="action_survey_user_input_dev" model="ir.actions.act_window">
            <field name="name">Survey Question Types</field>
            <field name="res_model">survey.user_input</field>
            <field name="view_mode">tree,form</field>
        </record>

        <record id="action_survey_answer_dev" model="ir.actions.act_window">
            <field name="name">Survey Answers</field>
            <field name="res_model">survey.user_input_line</field>
            <field name="view_mode">tree,form</field>
        </record>

        <!--Survey start button change-->
        <template id="survey.survey_init" name="Survey">
            <t t-call="website.layout">
                <div class="wrap">
                    <div class="oe_structure" />
                    <div class="container">
                        <t t-call="survey.back" />
                        <div class='jumbotron mt32'>
                            <h1 t-field='survey.title' />
                            <div t-field='survey.description' class="oe_no_empty"/>
                            <a class="btn btn-primary ml4 btn-lg" t-att-href="'/survey/fill/%s/%s' % (slug(survey), token)">
                                Start
                            </a>
                        </div>
                    </div>
                    <div class="oe_structure" />
                </div>
            </t>
        </template>

        <!--Survey submit button change-->
        <template id="survey.page" name="Page">
            <div class="page-header">
                <p class="pull-right">Page <span t-raw='page_nr + 1'/> of <span t-raw="len(survey.page_ids)"/></p>
                <h1 t-field='page.title' />
                <div t-field='page.description' class="oe_no_empty"/>
            </div>

            <form role="form" method="post" class="js_surveyform" t-att-name="'%s_%s' % (survey.id, page.id)" t-att-action="'/survey/fill/%s/%s' % (slug(survey), token)" t-att-data-prefill="'/survey/prefill/%s/%s/%s' % (slug(survey), token, slug(page))" t-att-data-validate="'/survey/validate/%s' % (slug(survey))" t-att-data-submit="'/survey/submit/%s' % (slug(survey))">
                <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                <input type="hidden" name="page_id" t-att-value="page.id" />
                <input type="hidden" name="token" t-att-value="token" />
                <t t-foreach='page.question_ids' t-as='question'>
                    <t t-set="prefix" t-value="'%s_%s_%s' % (survey.id, page.id, question.id)" />
                    <div class="js_question-wrapper" t-att-id="prefix">
                        <h2>
                            <span t-field='question.question' />
                            <span t-if="question.constr_mandatory" class="text-danger">*</span>
                        </h2>
                        <div t-field='question.description' class="text-muted oe_no_empty"/>
                        <t t-if="question.type == 'free_text'"><t t-call="survey.free_text"/></t>
                        <t t-if="question.type == 'textbox'"><t t-call="survey.textbox"/></t>
                        <t t-if="question.type == 'numerical_box'"><t t-call="survey.numerical_box"/></t>
                        <t t-if="question.type == 'date'"><t t-call="survey.date"/></t>
                        <t t-if="question.type == 'simple_choice'"><t t-call="survey.simple_choice"/></t>
                        <t t-if="question.type == 'multiple_choice'"><t t-call="survey.multiple_choice"/></t>
                        <t t-if="question.type == 'matrix'"><t t-call="survey.matrix"/></t>
                        <div class="js_errzone alert alert-danger" style="display:none;"></div>
                    </div>
                </t>
                <div class="text-center mt16 mb16">
                    <button t-if="survey.users_can_go_back and page_nr > 0" type="submit" class="btn btn-default" name="button_submit" value="previous">Previous page</button>
                    <button t-if="not last" type="submit" class="btn btn-primary ml4" name="button_submit" value="next">Next page</button>
                    <button t-if="last" type="submit" class="btn btn-primary ml4" name="button_submit" value="finish">Submit</button>
                </div>
            </form>

            <!-- Modal used to display error message, i.c.o. ajax error -->
            <div class="modal fade" id="AJAXErrorModal" role="dialog" aria-labelledby="AJAXErrorModal" aria-hidden="true" >
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&amp;times;</button>
                            <h4 class="modal-title">A problem has occured</h4>
                        </div>
                        <div class="modal-body"><p>Something went wrong while contacting survey server. <strong class="text-danger">Your answers have probably not been recorded.</strong> Try refreshing.</p></div>
                        <div class="modal-footer"><button type="button" class="btn btn-primary ml4" data-dismiss="modal">Close</button></div>
                    </div>
                </div>
            </div>
        </template>

        <!--Back to meeting button-->
        <template id="back_button_meeting" name="Back button" inherit_id="survey.back">
            <xpath expr="//div" position="replace">
                <div class="survey_back_btn_container">
                    <div  t-if="survey.meeting_id" t-ignore="true" class="pull-right">
                        <a t-attf-href="/web#view_type=form&amp;model=calendar.event&amp;id=#{survey.meeting_id.id}&amp;action=meeting_point.action_upcoming_meeting" class="btn btn-default">Back to meeting</a>
                    </div>
                    <div  t-ignore="true" class="pull-right">
                        <a t-attf-href="/web#view_type=form&amp;model=meeting_point.news&amp;id=1&amp;action=meeting_point.action_news_user_home" class="btn btn-default">Back to Home Page</a>
                    </div>
                    <div groups="meeting_point.group_meeting_admin" t-ignore="true" class="pull-right">
                        <a t-attf-href="/web#view_type=form&amp;model=survey.survey&amp;id=#{survey.id}&amp;action=meeting_point.action_survey_admin" class="btn btn-default">Back to Survey</a>
                    </div>
                </div>
            </xpath>
        </template>
        <template id="design_survey_front" inherit_id="website.assets_frontend" name="Survey Front Asserts">
            <xpath expr="." position="inside">
                <link rel="stylesheet" href="/meeting_point/static/css/survey.css"/>
            </xpath>
        </template>

    </data>
</odoo>