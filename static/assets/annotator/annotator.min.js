!function(){var e,t=0,n=[],o=!1,r=!1,i=!1,a=!1,s=!1,u=!1,c=void 0,d=void 0,l=function(){console.log("Load comment not defined")},f=function(){console.log("Save annotation not defined")},p=function(){console.log("onAnnotationsDownloaded not defined")};function v(e){localStorage.setItem(e+"/version",0),localStorage.setItem(e+"/scale",1),localStorage.setItem(e+"/roate",0),localStorage.setItem(e+"/dirty",0),localStorage.setItem(e+"/annotations","[]")}function m(e){var t=_(e,e+"/version");return isNaN(t)&&bootbox.alert("Cookie1 must have been se, plz contact support"),t}function h(e){var t=_(e,e+"/dirty");return isNaN(t)&&bootbox.alert("Cookie2 must have been set for "+e+", plz contact support"),t}function y(e){if(1!=h(e)){var t=_(e,e+"/version");t+=1,localStorage.setItem(e+"/version",t),localStorage.setItem(e+"/dirty",1)}}function g(e){localStorage.setItem(e+"/dirty",0)}function b(e,t){localStorage.setItem(e+"/version",t)}function _(e,t){w(e,t);var n=localStorage.getItem(t);return isNaN(n)||(n=parseFloat(n)),n}function x(e,t,n){var o=w(e,t);"dirty"!=o&&"version"!=o||(bootbox.alert("Should not happend"),console.trace()),localStorage.setItem(t,n)}function w(e,t){var n=t.replace(e+"/","");return-1==["version","annotations","dirty","scale","rotate","pen/size","pen/color","text/size","text/color"].indexOf(n)&&(console.trace(),bootbox.alert("Please report this issue2 with "+t+" for "+e)),n}var A=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);o=!0);}catch(e){r=!0,i=e}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();$(function(){var e=!1;$(document).on("mouseup","#viewer",function(n){2!=n.button&&1==t&&setTimeout(function(){var o=window.getSelection();if(1!=t||"Range"!=o.type||0==o.baseOffset&&0==o.focusOffset){var r=$(".toolbar .pen").hasClass("active"),i=$(".toolbar .cursor").hasClass("active");$(".toolbar .comment").hasClass("active")?e?e=!0:(e=!1,i||$(".toolbar .cursor").click()):r||i||$(".toolbar .cursor").click()}else{var s=$(".annotation-options.ContextMenuPopup");s.css({left:n.pageX-s.width()/2,top:n.clientY+12}).show(),a=!0}},10)})});var S=function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}return n.m=e,n.c=t,n.p="",n(0)}([function(w,A,S){try{var k,C,E,L,P=T(S(2)),I=(T(S(4)),function(){}),O=void 0,M=void 0,N=!1;$(document).height(),$(document).width(),window.init_doc_comments=function(){C=$("#comment-wrapper"),(k=C.find("#commentText")).focus(function(){u=!0}),k.blur(function(){u=!1}),E=C.find(".comment-list:first"),L=C.find(".comment-list-container:first"),$(".toolbar:first .cursor:first").click()};var j=void 0,R=!1;function T(e){return e&&e.__esModule?e:{default:e}}var B=P.default.UI,D={};P.default.setStoreAdapter(new P.default.LocalStoreAdapter);var q=0,F=void 0,z=P.default.getStoreAdapter();ae="",function(){function e(e,t,n,o){if(0==e.length&&(e=K()),0!=e.length||0!=n.length){(e=(e=e.filter(function(e){return"point"!=e.type||e.sub_type})).concat(n)).forEach(function(e){e.class="Annotation"});var r="";Array.isArray(e)?(r=JSON.stringify(e),x(N,N+"/annotations",r),b(N,t),g(N),oe(o)):bootbox.alert("invalid annotations")}else o&&o.first_time&&oe(o)}p=function(t,n){var o=t.comments;Array.isArray(o)||(o=[],console.log("Why not comments"));var r=m(N);t.annotations||(t.annotations=[]);var i=void 0,a=h(N);t.version>r?1==a?(i="Document annotation version="+t.version+" available from server,",i+="<br>You have older version="+r+" at local.",i+="<br>If you download, it will discard your recent changes,",i+="<br>Do you still want to download?",bootbox.confirm(i,function(r){e(r?t.annotations:[],t.version,o,n)})):e(t.annotations,t.version,o,n):e([],t.version,o,n)}}(),function(){function e(e){console.log(e)}f=function(t){if(I(1),N){if(1==h(N)){var n=m(N),o={id:doc_id,doc_id:N};if(delete o.reset,"reset"==t)o.reset=1;else{var r=localStorage.getItem(N+"/annotations");if(!r||"[]"==r)return void console.log("No annotations");0==n&&(y(N),b(N,1)),o.annotations=r,o.version=n}dn_rpc_object({data:{args:{app:"documents",model:"AnnotationDocument",method:"add_annotation"},params:o},no_loader:1,onSuccess:function(e){!function(e,t){if("done"!=e){if(isNaN(e))return bootbox.alert("Could not save:"),void console.log(e);var n=m(N);ae="Server already has version="+e,ae+="<br>Do you want to overwrite server version with local="+n+"?",bootbox.confirm(ae,function(t){t&&(b(n=e+1),f())})}else"reset"==t?(v(N),ne()):g(N),console.log("Saved")}(e,t)},onError:e,type:"post"})}}else console.log("saveAnnotationsAtServer must be called after document id is set")},window.saveAnnotationsAtServer=f,$("body").on("click",".doc-saver",function(){f()})}(),$("body").on("click",".cb-container.autosave input",function(){$(this).prop("checked")&&f()}),$("body").on("click",".toolbar .back",function(){H()}),$("body").on("click",".doc-clearer",function(){ae="Do you want to erase all annotations on document.",ae+="<br>Warning: it will disable autosave to not affect the online vesion.",bootbox.confirm(ae,function(e){e&&(function(e){localStorage.setItem(e+"/version",0),localStorage.setItem(e+"/annotations","[]")}(N),$(".cb-container.autosave input").prop("checked",!1),ne())})}),$("body").on("click",".doc-reseter",function(){ae="Do you want to erase all annotations on document.",ae+="<br>Warning: It will also reset.",bootbox.confirm(ae,function(e){if(e){var t=localStorage.getItem(N+"/annotations");t=(t=JSON.parse(t)).filter(function(e){return"point"==e.type&&!e.sub_type}),t=JSON.stringify(t),localStorage.removeItem(N+"/annotations"),localStorage.setItem(N+"/annotations",t),y(N),f("reset")}})}),$(window).unload(function(){H()}),$("body").on("click",".ContextMenuPopup.toolbar:first .copy:first",function(){document.execCommand("copy"),$(this).parent().parent().hide()}),$(document).mousedown(function(e){if(2!=e.button){var t=$(e.target);u&&0==t.closest("#comment-wrapper").length&&(u=!1,l()),!a||t.is(".ContextMenuPopup button")||t.is(".ContextMenuPopup .colored")||$(".ContextMenuPopup").hide(),$(".topbar:first .pen:first").hasClass("active")?n.length>0&&0==t.closest("#viewer").length&&I():($(".pdfViewer").css("cursor","default"),t.closest(".annotation_button.prop").length>0?$(".topbar:first .pen:first").click():M&&0==t.closest("#comment-wrapper").length?(M=void 0,$(".comment-list-form").hide()):$(".toolbar .comment").hasClass("active")&&0==t.closest("#viewer").length&&$(".toolbar .cursor").click())}}),$("body").on("click",".cell.colored",function(){var e=$(this),t=e.attr("hex").substring(1);j?j.color!=t&&(j.color=t,z.editAnnotation(N,O,j).then(function(t){e.append($("#applied_color").show())})):($(".topbar .pen-color:first").css("background",t),$(".topbar .pen-color:first").attr("color",t),U(null,t),e.append($("#applied_color").show()))});var U=function(e,t){},W="top",Y="left",X=void 0;function V(e,t){for(var n in e=e.filter(function(e){return"point"==e.type&&!e.sub_type})){var o=e[n],r="<div point_id="+o.uuid+' class="new_comments_count"',i=o.y*X-15,a=o.x*X+15,s=W+":"+i+"px;"+Y+":"+a+"px;";0==o.counter&&(s+="display:none;"),r+=' style="'+s+'" comment_count="'+o.counter+'">'+o.counter+"</div>",$("#pageContainer"+t+" .canvasWrapper").append(r)}}function J(){C.hide(),o=!1,localStorage.removeItem(N+"/shown_comment_type")}function G(e){e&&(r=e),"notes"==r?C.find(".title:first").html("Personal Notes"):C.find(".title:first").html("Comments"),C.show(),M?$(".comment-list-form").show():$(".comment-list-form").hide(),o=r,localStorage.setItem(N+"/shown_comment_type",o)}function H(){$("#annotated-doc-conatiner").hide(),o=!1,C.hide(),$(".router-outlet").show(),f("Leaving")}function Z(){site_functions.hideLoader("renderdoc"),site_functions.hideLoader("loaddocwaiter")}function K(){var e=_(N,N+"/annotations");return e=e?JSON.parse(e):[]}function Q(){k.val(""),k.parent().show(),L.css("padding-bottom","65px"),E.scrollTop(999999e3),k.focus()}function ee(e,t){e.counter=0,te(e,0),window.socket_manager.removeNotification("annotations","Point",e.id)}function te(e,t,n){var o=_(N,N+"/annotations");for(var r in o=o?JSON.parse(o):[])if(o[r].uuid==e.uuid){var i=0;if(0!=t&&(i=t,o[r].counter&&(i+=o[r].counter)),e.counter=i,o[r].counter=i,!n){var a=$('.new_comments_count[point_id="'+e.uuid+'"]');0==i?a.hide():a.show(),a.html(i).attr("comment_count",i)}localStorage.setItem(N+"/annotations",JSON.stringify(o));break}}function ne(t){if(e=window.current_user.cookie,site_functions.showLoader("renderdoc"),t&&t.first_time)if(C=$("#comment-wrapper"),k=C.find("#commentText"),E=C.find(".comment-list:first"),L=C.find(".comment-list-container:first"),s=t.type+"-"+t.id+".pdf",N=t.type+"-"+t.id+"-"+e.id+".pdf",doc_id=t.id,D.documentId=N,R=!1,localStorage.getItem(N+"/dirty")||v(N),"meeting"==t.type||"topic"==t.type){var n=m(N),o=doc_id;o={args:{app:"documents",model:"AnnotationDocument",method:"get_annotations"},params:{id:doc_id,doc_id:N,version:n}},dn_rpc_object({data:o,no_loader:1,onSuccess:function(e){p(e,t)},onError:function(e){console.log(e)}})}else oe(t);else setTimeout(oe,100)}function oe(e){try{var n=0;if(e&&e.first_time){"meeting"==e.type||"topic"==e.type?window.show_annotation=!0:window.show_annotation=!1,$(".topbar:first .annotation_button").hide(),$("#content-wrapper").hide(),$(".strt_sign.pdfjs").hide(),$(".sign_completed.pdfjs").hide(),$(".router-outlet").hide(),$(".doc-reseter").hide(),$(".toolbar.topbar:first").show(),$("#annotated-doc-conatiner").show(),J(),function(){function e(e,t){e=parseFloat(e,10),t=parseInt(t,10),$("#viewer").width(),D.scale,(D.scale!==e||D.rotate!==t)&&(D.scale=e,D.rotate=t,x(D.documentId,D.documentId+"/scale",D.scale),_(D.documentId,D.documentId+"/scale"),x(D.documentId,D.documentId+"/rotate",D.rotate%360),ne())}var t=document.querySelector(".toolbar select.scale");function n(){e(t.value,D.rotate)}t.addEventListener("change",n),document.querySelector(".toolbar .rotate-ccw").addEventListener("click",function(){e(D.scale,D.rotate-90)}),document.querySelector(".toolbar .rotate-cw").addEventListener("click",function(){e(D.scale,D.rotate+90)}),$("body").on("click",".toolbar:first .zoomin",function(){if(!(D.scale>=5)){var e=t.children[t.selectedIndex];t.value=$(e).next().val(),n()}}),$("body").on("click",".toolbar:first .zoomout",function(){if(!(D.scale<=.25)){var e=t.children[t.selectedIndex];t.value=$(e).prev().val(),n()}})}();var o=$(".toolbar select.scale:first");if((D={documentId:N,scale:_(N,N+"/scale"),rotate:_(N,N+"/rotate"),pdfDocument:null}).rotate||(D.rotate=360,x(N,N+"/rotate",360)),D.scale||(D.scale=1,x(N,N+"/scale",1)),o.val(D.scale),!e.type)return bootbox.alert("Invalid document data ",e),void Z();e.doc.startsWith("data:application/pdf;base64,")&&(e.doc=e.doc.replace("data:application/pdf;base64,",""));for(var r=atob(e.doc),i=new Uint8Array(r.length),a=0;a<r.length;a++)i[a]=r.charCodeAt(a);e.doc=i,D.document_data=e,PDFJS.getDocument(e.doc).then(function(e){F=e,$(".page-count").html(F.numPages),F.numPages>1&&$(".page-next-btn").removeAttr("disabled"),s(F)})}else{if(!D.document_data)return bootbox.alert("Invalid render options data ",D),void Z();D.document_data.doc,N=D.documentId,s(F)}function s(o){if(!o)return alert("PDF not loaded"),void Z();D.pdfDocument=o;var r=document.getElementById("viewer");r.innerHTML="",q=o.pdfInfo.numPages;for(var i=0;i<q;i++){var a=B.createPage(i+1);r.appendChild(a)}X=$("select.scale").val();var s=D.rotate%360;switch(function(e){var n=D.document_data,o=n.type;if(0!=e||"meeting"!=o&&"topic"!=o)t=0,$(".annot-toggler").hide(),"meeting"!=o&&"topic"!=o||(t=2),D.showAnnotations=!1,$(".topbar:first .annotation_button").hide(),"signature"==n.type&&($(".strt_sign").attr("doc_id",n.id),"Pending"==n.mp_signature_status&&($(".sign_completed.pdfjs").hide(),$(".strt_sign.pdfjs").show()),"Completed"==n.mp_signature_status&&($(".strt_sign.pdfjs").hide(),$(".sign_completed.pdfjs").show()));else{t=1,D.showAnnotations=!0;var r=_(D.documentId,D.documentId+"/pen/size")||1,i=_(D.documentId,D.documentId+"/pen/color")||"#000000";U(r,i),$(".topbar:first .annotation_button").show(),$(".annot-toggler").show()}}(s),s){case 90:W="right",Y="top";break;case 180:W="bottom",Y="right";break;case 270:W="left",Y="bottom"}function u(o,r){if(1==++n){if(first_page_rendered=1,e&&e.first_time){var i=$(".headerheight").height()+$(".topbar:first")[0].getBoundingClientRect().height;"iframe"==window.pathname.split("/")[1]&&(i+=137),$("#viewer-wrapper").css({height:"calc(100vh - "+i+"px)"}),$("body").addClass("pdf-viewer")}$("#content-wrapper").show(),Z()}1==t&&V(o,r)}B.renderPage(1,D,function(e,t){u(e,t);for(var n=2;n<=q;n++)B.renderPage(n,D,function(e,t){u(e,t)})})}window.show_annotation?($(".annotationLayer").show(),$(".annotation_button").show()):($(".annotationLayer").hide(),$(".annotation_button").hide())}catch(e){console.log(e)}}I=function(e){if(n.length>0){var t=_(N,N+"/annotations");t=JSON.parse(t);var o=n[0];t=t.filter(function(e){return 1!=e.to_merge});for(var r=1;r<n.length;r++)o.lines=o.lines.concat(n[r].lines);o.to_merge=0,t.push(o),localStorage.setItem(N+"/annotations",JSON.stringify(t)),n=[],o={},e||oe()}},re=void 0,ie=void 0,U=function(e,t){var n=!1;e&&"number"!=typeof e&&(e=parseInt(e)),t&&6==t.length&&(t="#"+t),e&&re!==e&&(n=!0,re=e,x(D.documentId,D.documentId+"/pen/size",re),document.querySelector(".toolbar .pen-size").value=re),t&&ie!==t&&(n=!0,ie=t,x(D.documentId,D.documentId+"/pen/color",ie),$(".toolbar .pen-color:first").css("background-color",ie),$(".toolbar .pen-color:first").attr("color",t),$("select.pen-size").css("color",t),$("select.pen-size option").css("color",t)),n&&B.setPen(re,ie)},$("body").on("click",".toolbar .pen-color:first",function(e){var t=$(".topbar:first").width(),n=$(".ColorPalettePopup:first"),o=this.getBoundingClientRect(),r={top:o.y+20};t/2>o.x?r.left=o.x:r.left=o.x-n.width(),n.css(r).show();var i=$(this).attr("color");n.find('div[hex="'+i+'"]:first').click()}),$("body").on("change",".toolbar .pen-size:first",function(e){U(e.target.value,ie)}),function(){var e="cursor";function t(t,n){B.disablePoint();var o=$(".toolbar button.active");if(o.length>0)switch(o.removeClass("active"),e){case"cursor":B.disableEdit();break;case"draw":B.disablePen();break;case"text":B.disableText();break;case"point":B.disablePoint();break;case"area":case"highlight":case"strikeout":case"underline":B.disableRect()}switch($(n).addClass("active"),e=t,t){case"cursor":B.enableEdit();break;case"draw":B.enablePen();break;case"text":B.enableText();break;case"point":$(".pdfViewer").css("cursor","crosshair"),B.enablePoint();break;case"area":case"highlight":case"strikeout":case"underline":B.enableRect(t)}}$("body").on("click",".toolbar.topbar:first button, .toolbar.annotation-options:first button",function(e){var n=$(".topbar:first .active"),o=$(e.target);if((o=o.closest("button")).hasClass("pen")&&n.hasClass("pen"))$(".topbar:first .cursor").click();else{var r=$(e.target).closest("[data-tooltype]").data("tooltype");r&&t(r,e.target)}o.hasClass("comment")&&(i=!!o.hasClass("personal")&&"personal")}),$(".toolbar:first .cursor").click()}(),function(n,o){n.on_annotation_comment_received=function(e){var n=$("#annotated-doc-conatiner");if(!(n.length<1)&&(n=n.is(":visible"))&&1==t&&n&&e.point.comment_doc_id==s){var o=L.attr("annotation-id");if(e.new_point){e.point.counter=1;var r=K();r.push(e.point),r=JSON.stringify(r),x(N,N+"/annotations",r),B.renderPage(e.point.page,D,function(t,n){z.addComment(N,e.point.uuid,e.point.comment,1).then(function(e){h(e,1),C.find(".comment-list-item:last").css({background:"green",color:"white"})}),V(t,n),te(e.point,1,1)})}else e.point.uuid==o?(z.addComment(N,e.point.uuid,e.point.comment,1).then(function(e){h(e,1),C.find(".comment-list-item:last").css({background:"green",color:"white"})}),ee(e.point)):(z.addComment(N,e.point.uuid,e.point.comment,1),te(e.point,1))}};var i=localStorage.getItem("user");function u(e){R=1,setTimeout(function(){e?c(e):(G(r),k.closest("form").hide(),L.css("padding-bottom","5px"))},11)}function f(e,t,n){var r=o.createElement("div");for(var i in r.classList.add("groupcomment"),e){var a=m(e[i]);r.appendChild(a)}$(r).attr("annotationId",t),L.append(r)}function p(e){L.html(""),e.forEach(h)}i=JSON.parse(i),$("body").on("keyup","#commentText",function(t){if(M){if(!t.shiftKey&&13==t.keyCode){t.preventDefault();var n=k[0].value;if(""==(n=n.substr(0,n.length-1)))return void k.val("");var o={date_time:new Date,user_name:e.name,uid:e.id,content:n};if(!o.content)return!1;z.addComment(N,M,o).then(function(e){h(e,1)})}}else console.log("Comment not added because, no active annotationId")}),l=function(e){L.html(""),L.removeAttr("annotation-id");var t=!1;"notes"==r&&(t="personal"),z.getPointAnnotations(N,t).then(function(t){(t=t.annotations).sort(function(e,t){return e.page-t.page||e.y-t.y||e.x-t.x});var n=-1,o=-1,r=t.length;for(var i in t)++n,z.getComments(N,t[n].uuid).then(function(n){var i=t[++o];f(n,i.uuid,i.sub_type),o+1==r&&u(e)});-1==n&&u(e)})};var v=!1;function m(e){var t=o.createElement("div");t.className="comment-list-item";var r="<div>"+e.content+"</div>";return e.date_time=n.dt_functions.standeredTime(e.date_time),r+='<div class="user-time-info">',r+='<span class"time">'+e.date_time+"</span>",r+='<span class="user">'+e.user_name+"</span>",r+="</div>",$(t).attr("comment-id",e.uuid),$(t).attr("annotation",e.annotation),t.innerHTML=r,t}function h(e,t){var n=m(e);L.append(n),t&&Q()}$("body").on("click","#comment-wrapper .buttons",function(e){e.preventDefault(),a=!0,v=$(this).closest(".comment-list-item"),$(".update-comment:first").css({top:e.pageY,left:e.pageX}).show()}),$("body").on("click",".annotation_button.unread",function(){for(var e=$(".canvasWrapper .new_comments_count"),t=e.length,n=0;n<t;n++){var o=e.eq(n);if(parseInt(o.html())>0){c(o.attr("point_id"));break}}}),$("body").on("click",".update-comment:first .delete",function(e){var t=v.closest(".groupcomment"),n=v.attr("comment-id"),o=v.attr("annotation");z.deleteComment(N,o,n).then(function(){1==t.children(".comment-list-item").length?t.remove():v.remove(),a=!1,$(".update-comment").hide()})}),$("body").on("click",".show-all-comments",function(){setTimeout(J,50)}),c=function(e){if(R){var t=void 0;if(t="string"==typeof e?e:e.attr("annotationId")){var n=$("svg.annotationLayer").find('svg[data-pdf-annotate-id="'+t+'"]');if(n.length>0){var o=$('.canvasWrapper .new_comments_count[point_id="'+t+'"]');setTimeout(function(){$("#viewer-wrapper").scrollTop(0);var e=o.closest(".canvasWrapper"),t=e.height()*e.closest(".page").index(),r=o[0];if(r){var i=parseFloat(r.style.top)-100,a=parseFloat(r.style.left)-100,s=t+i;$("#viewer-wrapper").scrollLeft(a),$("#viewer-wrapper").animate({scrollTop:s},500)}B.enableEdit(n[0]),d(n[0])},15)}else console.log(target,"Not found")}else console.log("Invalid point id")}else l(e)},$("body").on("click","#comment-wrapper .groupcomment",function(e){$(e.target).is(".buttons")||c($(this))}),d=function(e){O=e.getAttribute("data-pdf-annotate-id"),z.getAnnotation(N,O).then(function(t){if(j=t,function(e){var t=e.getAttribute("data-pdf-annotate-type");return["point"].indexOf(t)>-1}(e))M=O,z.getComments(N,O).then(p).then(function(){if(t.counter>0){var e=C.find(".comment-list-item").length;e=e-t.counter-1,C.find(".comment-list-item:gt("+e+")").css({background:"green",color:"white"}),ee(t,t.counter)}}),j.sub_type?(L.removeAttr("annotation-id"),G("notes")):(L.attr("annotation-id",O),$("#pdf-annotate-edit-overlay a").remove(),G("comments")),Q();else{var n=$(".colors.ContextMenuPopup:first"),o=$(e).position(),r=$("#pdf-annotate-edit-overlay:visible").width(),i=n.width(),s=o.left+r/2-i/2,u=$(e).attr("fill");u||(u=$(e).attr("stroke")),"none"!=u&&u||(u="#000000");var c=n.find('.row>.cell[hex="'+u+'"]');0==c.length?$("#applied_color").hide():c.append($("#applied_color").show()),n.css({left:s,top:o.top+30}).show(),a=!0}})},$(n).width(),$(n).height(),$(o).height(),$("body").on("click",".toolbar:first .comment",function(e){B.destroyEditOverlay(),r=$(this).is(".personal")?"notes":"comments",l()}),B.addEventListener("annotation:click",d),B.addEventListener("annotation:blur",function(e){j=!1})}(window,document),A.render=ne}catch(e){console.log(e)}var re,ie;var ae},function(e,t,n){!function(){if(null==e)var e={};e.txt={}}()},function(t,o,r){var a,u,d;(function(t){"use strict";var r,l=void 0,p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};r=function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}return n.m=e,n.c=t,n.p="",n(0)}([function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(1),i=(o=r)&&o.__esModule?o:{default:o};t.default=i.default,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var o=s(n(2)),r=s(n(8)),i=s(n(10)),a=s(n(28));function s(e){return e&&e.__esModule?e:{default:e}}t.default={StoreAdapter:o.default,LocalStoreAdapter:r.default,__storeAdapter:new o.default,getStoreAdapter:function(){return this.__storeAdapter},setStoreAdapter:function(e){this.__storeAdapter=e},UI:a.default,render:i.default,getAnnotations:function(e,t){var n;return(n=this.getStoreAdapter()).getAnnotations.apply(n,arguments)}},e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var o,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(3),a=(o=i)&&o.__esModule?o:{default:o},s=n(4),u=function(){function e(){var t=this,n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.keys(n).forEach(function(e){"function"==typeof n[e]&&"function"==typeof t[e]&&(t[e]=n[e])})}return r(e,[{key:"__getAnnotations",value:function(e,t){(0,a.default)("getAnnotations")}},{key:"getAnnotation",value:function(e,t){(0,a.default)("getAnnotation")}},{key:"getCommentAnnotations",value:function(e){(0,a.default)("getCommentAnnotations")}},{key:"getPointAnnotations",value:function(e,t){(0,a.default)("getPointAnnotations")}},{key:"__addAnnotation",value:function(e,t,n){(0,a.default)("addAnnotation")}},{key:"__editAnnotation",value:function(e,t,n){(0,a.default)("editAnnotation"),destroyEditOverlay()}},{key:"__deleteAnnotation",value:function(e,t){(0,a.default)("deleteAnnotation")}},{key:"getComments",value:function(e,t){(0,a.default)("getComments")}},{key:"getAllComments",value:function(e){(0,a.default)("getAllComments")}},{key:"__addComment",value:function(e,t,n){(0,a.default)("addComment")}},{key:"__editComment",value:function(e,t){(0,a.default)("editComment")}},{key:"__deleteComment",value:function(e,t,n){(0,a.default)("deleteComment")}},{key:"getAnnotations",get:function(){return this.__getAnnotations},set:function(e){this.__getAnnotations=function(t,n){return e.apply(void 0,arguments).then(function(e){return e.annotations&&e.annotations.forEach(function(e){e.documentId=t}),e})}}},{key:"addAnnotation",get:function(){return this.__addAnnotation},set:function(e){this.__addAnnotation=function(t,n,o){return e.apply(void 0,arguments).then(function(e){return(0,s.fireEvent)("annotation:add",t,n,e),e})}}},{key:"editAnnotation",get:function(){return this.__editAnnotation},set:function(e){this.__editAnnotation=function(t,n,o){return e.apply(void 0,arguments).then(function(e){return(0,s.fireEvent)("annotation:edit",t,n,e),e})}}},{key:"deleteAnnotation",get:function(){return this.__deleteAnnotation},set:function(e){this.__deleteAnnotation=function(t,n){return e.apply(void 0,arguments).then(function(e){return e&&(0,s.fireEvent)("annotation:delete",t,n),e})}}},{key:"addComment",get:function(){return this.__addComment},set:function(e){this.__addComment=function(t,n,o){return e.apply(void 0,arguments).then(function(e){return(0,s.fireEvent)("comment:add",t,n,e),e})}}},{key:"editComment",get:function(){return this.__editComment},set:function(e){this.__editComment=function(t,n){return e.apply(void 0,arguments).then(function(e){return e&&(0,s.fireEvent)("comment:edit",t,n),e})}}},{key:"deleteComment",get:function(){return this.__deleteComment},set:function(e){this.__deleteComment=function(t,n,o){return e.apply(void 0,arguments).then(function(e){return e&&(0,s.fireEvent)("comment:delete",t,n,o),e})}}}]),e}();t.default=u,e.exports=t.default},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){throw new Error(e+" is not implemented")},e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.fireEvent=function(){s.emit.apply(s,arguments)},t.addEventListener=function(){s.on.apply(s,arguments)},t.removeEventListener=function(){s.removeListener.apply(s,arguments)};var o,r=n(5),i=(o=r)&&o.__esModule?o:{default:o},a=n(6),s=new i.default,u=void 0;document.addEventListener("click",function(e){if($(".toolbar .cursor").hasClass("active")&&(0,a.findSVGAtPoint)(e.clientX,e.clientY)){var t=(0,a.findAnnotationAtPoint)(e.clientX,e.clientY);u&&u!==t&&s.emit("annotation:blur",u),t&&s.emit("annotation:click",t),u=t}})},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(e){return"function"==typeof e}function r(e){return"object"===(void 0===e?"undefined":p(e))&&null!==e}function i(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,a,s,u,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||r(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(i(n=this._events[e]))return!1;if(o(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(r(n))for(s=Array.prototype.slice.call(arguments,1),a=(c=n.slice()).length,u=0;u<a;u++)c[u].apply(this,s);return!0},n.prototype.addListener=function(e,t){var a;if(!o(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,o(t.listener)?t.listener:t),this._events[e]?r(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,r(this._events[e])&&!this._events[e].warned&&(a=i(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&a>0&&this._events[e].length>a&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){if(!o(t))throw TypeError("listener must be a function");var n=!1;function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}return r.listener=t,this.on(e,r),this},n.prototype.removeListener=function(e,t){var n,i,a,s;if(!o(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(a=(n=this._events[e]).length,i=-1,n===t||o(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(r(n)){for(s=a;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){i=s;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(o(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?o(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(o(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.BORDER_COLOR=void 0,t.findSVGContainer=function(e){for(var t=e;(t=t.parentNode)&&t!==document;)if("SVG"===t.nodeName.toUpperCase()&&"true"===t.getAttribute("data-pdf-annotate-container"))return t;return null},t.findSVGAtPoint=s,t.findAnnotationAtPoint=function(e,t){var n=s(e,t);if(n){for(var o=n.querySelectorAll("[data-pdf-annotate-type]"),r=0,i=o.length;r<i;r++){var a=o[r];if(u(e,t,c(a)))return a}return null}},t.pointIntersectsRect=u,t.getOffsetAnnotationRect=c,t.getAnnotationRect=d,t.scaleUp=l,t.scaleDown=function(e,t){var n={},o=p(e).viewport;return Object.keys(t).forEach(function(e){n[e]=t[e]/o.scale}),n},t.getScroll=function(e){for(var t=0,n=0,o=e;(o=o.parentNode)&&o!==document;)t+=o.scrollTop,n+=o.scrollLeft;return{scrollTop:t,scrollLeft:n}},t.getOffset=f,t.disableUserSelect=function(){a.parentNode||document.head.appendChild(a)},t.enableUserSelect=function(){a.parentNode&&a.parentNode.removeChild(a)},t.getMetadata=p;var o,r=n(7),i=(o=r)&&o.__esModule?o:{default:o};t.BORDER_COLOR="#00BFFF";var a=(0,i.default)({body:{"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"}});function s(e,t){for(var n=document.querySelectorAll('svg[data-pdf-annotate-container="true"]'),o=0,r=n.length;o<r;o++){var i=n[o];if(u(e,t,i.getBoundingClientRect()))return i}return null}function u(e,t,n){return t>=n.top&&t<=n.bottom&&e>=n.left&&e<=n.right}function c(e){var t=d(e),n=f(e),o=n.offsetLeft,r=n.offsetTop;return{top:t.top+r,left:t.left+o,right:t.right+o,bottom:t.bottom+r}}function d(e){var t=0,n=0,o=0,r=0,i=e.getBoundingClientRect();switch(e.nodeName.toLowerCase()){case"path":var a=void 0,u=void 0,c=void 0,d=void 0;e.getAttribute("d").replace(/Z/,"").split("M").splice(1).forEach(function(e){var t=e.split(" ").map(function(e){return parseInt(e,10)});(void 0===a||t[0]<a)&&(a=t[0]),(void 0===u||t[2]>u)&&(u=t[2]),(void 0===c||t[1]<c)&&(c=t[1]),(void 0===d||t[3]>d)&&(d=t[3])}),t=d-c,n=u-a,o=a,r=c;break;case"line":t=parseInt(e.getAttribute("y2"),10)-parseInt(e.getAttribute("y1"),10),n=parseInt(e.getAttribute("x2"),10)-parseInt(e.getAttribute("x1"),10),o=parseInt(e.getAttribute("x1"),10),r=parseInt(e.getAttribute("y1"),10),0===t&&(t+=16,r-=8);break;case"text":t=i.height,n=i.width,o=parseInt(e.getAttribute("x"),10),r=parseInt(e.getAttribute("y"),10)-t;break;case"g":var p=f(e),v=p.offsetLeft,m=p.offsetTop;t=i.height,n=i.width,o=i.left-v,r=i.top-m,"strikeout"===e.getAttribute("data-pdf-annotate-type")?(t+=16,r-=8):"underline"===e.getAttribute("data-pdf-annotate-type")&&(t+=16,r-=14);break;case"rect":case"svg":t=parseInt(e.getAttribute("height"),10),n=parseInt(e.getAttribute("width"),10),o=parseInt(e.getAttribute("x"),10),r=parseInt(e.getAttribute("y"),10)}var h={top:r,left:o,width:n,height:t,right:o+n,bottom:r+t};return["svg","g"].includes(e.nodeName.toLowerCase())||(h=l(s(i.left,i.top),h)),h}function l(e,t){var n={},o=p(e).viewport;return Object.keys(t).forEach(function(e){n[e]=t[e]*o.scale}),n}function f(e){for(var t=e;(t=t.parentNode)&&t!==document&&"SVG"!==t.nodeName.toUpperCase(););var n=t.getBoundingClientRect();return{offsetLeft:n.left,offsetTop:n.top}}function p(e){return{documentId:e.getAttribute("data-pdf-annotate-document"),pageNumber:parseInt(e.getAttribute("data-pdf-annotate-page"),10),viewport:JSON.parse(e.getAttribute("data-pdf-annotate-viewport"))}}a.setAttribute("data-pdf-annotate-user-select","true")},function(e,t){e.exports=function(e){var t=document.createElement("style"),n=Object.keys(e).map(function(t){return function(e,t){return e+" {\n"+function(e){return Object.keys(e).map(function(t){return function(e,t){return isNaN(t)||0==t||(t+="px"),function(e){return e.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()})}(e)+": "+t+";"}(t,e[t])}).join("\n")}(t)+"\n}"}(t,e[t])}).join("\n");return t.setAttribute("type","text/css"),t.appendChild(document.createTextNode(n)),t}},function(t,o,r){Object.defineProperty(o,"__esModule",{value:!0});var i=u(r(9)),a=u(r(2));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(t){function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":p(t))&&"function"!=typeof t?e:t}(this,Object.getPrototypeOf(o).call(this,{getAnnotations:function(t,n){return new Promise(function(o,r){var i=d(t).filter(function(t){return t.page===n&&"Annotation"===t.class&&(t.uid==e.id||"point"==t.type&&!t.sub_type)});o({documentId:t,pageNumber:n,annotations:i})})},getCommentAnnotations:function(t,n){return new Promise(function(n,o){var r=d(t).filter(function(t){return"point"==t.type&&"Annotation"===t.class&&(t.uid==e.id||!t.sub_type)});n({documentId:t,annotations:r})})},getPointAnnotations:function(t,n){return new Promise(function(o,r){var i=d(t).filter(function(t){return n?"point"==t.type&&"Annotation"===t.class&&t.uid==e.id&&t.sub_type:"point"==t.type&&"Annotation"===t.class&&!t.sub_type});o({documentId:t,annotations:i})})},getCommentPoints:function(e){return this.getCommentAnnotations(e)},getNotePoints:function(e){return this.getCommentAnnotations(e,sub_type)},getAnnotation:function(e,t){return Promise.resolve(d(e)[m(e,t)])},addAnnotation:function(t,o,r){return new Promise(function(a,s){if("string"==typeof r.type)if(e.id)if(r.class="Annotation",r.uuid=(0,i.default)(),r.page=o,r.date_time=new Date,e.id){r.uid=e.id;var u=d(t);u.push(r),"drawing"==r.type&&(r.to_merge=1,n.push(r));var c="pooint"==r.type&&!r.sub_type;v(t,u,c),a(r)}else console.log("oops no user id");else bootbox.alert("No user Id given");else console.log("Invalid annotation",r)})},editAnnotation:function(e,t,n){return new Promise(function(o,r){var i=d(e);i[m(e,t)]=n,v(e,i),function(e,t,n){document.querySelectorAll('[data-pdf-annotate-id="'+e+'"]').forEach(function(e){var o=!1;switch(t){case"strikeout":case"underline":o="stroke";break;case"highlight":o="fill";break;case"drawing":-1==n.indexOf("#")&&(n="#"+n),$(e).attr("stroke",n),o="fill"}o&&$(e).attr(o,"#"+n)})}(t,n.type,n.color),o(n)})},deleteAnnotation:function(e,t){return new Promise(function(n,o){var r=m(e,t);if(r>-1){var i=d(e);i.splice(r,1),v(e,i)}n(!0)})},getComments:function(e,t){return new Promise(function(n,o){var r=d(e).filter(function(e){return e.uuid===t}),i=[];i=Array.isArray(r)&&r.length>0?r[0].comments:[],Array.isArray(i)||(i=[]),n(i)})},getAllComments:function(e){return new Promise(function(t,n){t(d(e).filter(function(e){return"point"===e.type}).sort(function(e,t){return e.page-t.page||e.y-t.y||e.x-t.x})||[])})},addComment:function(e,t,n,o){return new Promise(function(r,a){if(t){var u={class:"Comment",uuid:(0,i.default)(),point_id:t,content:n.content,uid:n.uid,user_name:n.user_name,date_time:n.date_time},c=e.split("-"),l=c[1].split(".")[0],f="meeting_point.doc";e.indexOf("topic")>-1&&(f="meeting_point.topicdoc");var p={doc_type:c[0],doc_id:e,comment_doc_id:s,parent_res_id:l,parent_res_model:f,res_model:"annotation.point"},m=d(e),h={},y=-1;for(var g in m)if(m[g].uuid==t){y=g;var b=m[g];for(var _ in b)"comments"!=_&&(h[_]=b[_]);break}if(y>-1){m[y].comments?m[y].comments.push(u):m[y].comments=[u],h.comment=u,h.doc_id=e,h.comment_doc_id=s,p.point=h;var x="personal"!=h.sub_type;x&&!o&&dn_rpc_object({data:{args:{app:"documents",model:"PointAnnotation",method:"save_comment"},params:p},no_loader:1,onSuccess:function(e){console.log("comment saved")},onError:function(e){console.log(e)}}),v(e,m,x)}else console.log("Annotation not found "+t)}else console.log("Comment not added because, no active annotationId");r(u)})},editComment:function(e,t,n,o){return new Promise(function(r,i){for(var a=d(e),s=0;s<a.length;s++)n===a[s].annotation&&t===a[s].uuid&&(a[s].content=o);v(e,a,1),r(!0)})},deleteComment:function(e,t,n){return new Promise(function(t,o){d(e);for(var r=-1,i=d(e),a=0,s=i.length;a<s;a++)if(i[a].uuid===n){r=a;break}r>-1&&(i.splice(r,1),v(e,i,1)),t(!0)})}}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":p(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(o,a.default),o}();function d(e){var t=_(e,e+"/annotations");return t=t?JSON.parse(t):[]}o.default=c;var l=void 0;function v(e,t,n){var o="";Array.isArray(t)&&(o=JSON.stringify(t)),x(e,e+"/annotations",o),n||(y(e),clearTimeout(l),l=setTimeout(function(){f()},3e4))}function m(e,t){for(var n=-1,o=d(e),r=0,i=o.length;r<i;r++)if(o[r].uuid===t){n=r;break}return n}t.exports=o.default},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return o.replace(n,r)};var n=/[xy]/g,o="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";function r(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){return new Promise(function(r,i){return e.innerHTML="",e.setAttribute("data-pdf-annotate-container",!0),e.setAttribute("data-pdf-annotate-viewport",JSON.stringify(t)),e.removeAttribute("data-pdf-annotate-document"),e.removeAttribute("data-pdf-annotate-page"),n?(e.setAttribute("data-pdf-annotate-document",n.documentId),e.setAttribute("data-pdf-annotate-page",n.pageNumber),Array.isArray(n.annotations)&&0!==n.annotations.length?(n.annotations.forEach(function(n){(0,o.default)(e,n,t)}),void r(e)):r(e)):r(e)})},r(n(1));var o=r(n(11));function r(e){return e&&e.__esModule?e:{default:e}}r(n(20)),e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){n||(n=JSON.parse(e.getAttribute("data-pdf-annotate-viewport")));var u=void 0;switch(t.type){case"area":case"highlight":u=(0,a.default)(t);break;case"strikeout":case"underline":u=(0,o.default)(t);break;case"point":u=(0,i.default)(t);break;case"textbox":u=(0,s.default)(t);break;case"drawing":u=(0,r.default)(t)}return u&&(u.setAttribute("data-pdf-annotate-id",t.uuid),u.setAttribute("data-pdf-annotate-type",t.type),u.setAttribute("aria-hidden",!0),e.appendChild(function(e,t){var n=function(e){var t=void 0,n=void 0,o=e.rotation%360;switch(o<0&&(o+=360),o){case 0:t=n=0;break;case 90:t=0,n=e.width/e.scale*-1;break;case 180:t=e.width/e.scale*-1,n=e.height/e.scale*-1;break;case 270:t=e.height/e.scale*-1,n=0}return{x:t,y:n}}(t),o="scale("+t.scale+")";if(o+=" rotate("+t.rotation+")",o+=" translate("+n.x+", "+n.y+")",e.setAttribute("transform",o),!c&&"svg"===e.nodeName.toLowerCase()){e.setAttribute("x",parseInt(e.getAttribute("x"),10)*t.scale),e.setAttribute("y",parseInt(e.getAttribute("y"),10)*t.scale);var r=parseInt(e.getAttribute("x",10)),i=parseInt(e.getAttribute("y",10)),a=parseInt(e.getAttribute("width"),10),s=parseInt(e.getAttribute("height"),10),u=(e.querySelector("path"),[e]),d=e.querySelector("svg"),l=e.querySelector("path"),f=e.querySelector("rect"),p=e.querySelector("g");d&&u.push(d),l&&u.push(l),f&&u.push(f),p&&u.push(p);var v=t.rotation%360;switch(v<0&&(v+=360),v){case 90:e.setAttribute("x",t.width-i-a),e.setAttribute("y",r),d&&(d.setAttribute("x",1),d.setAttribute("y",0));break;case 180:e.setAttribute("x",t.width-r-a),e.setAttribute("y",t.height-i-s),d&&d.setAttribute("y",2);break;case 270:e.setAttribute("x",i),e.setAttribute("y",t.height-r-s),d&&(d.setAttribute("x",-1),d.setAttribute("y",0))}}return e}(u,n))),u},u(n(12));var o=u(n(13)),r=u(n(16)),i=u(n(17)),a=u(n(18)),s=u(n(19));function u(e){return e&&e.__esModule?e:{default:e}}var c=/firefox/i.test(navigator.userAgent);e.exports=t.default},function(e,t){var n=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;e.exports=Object.assign||function(e,t){for(var r,i,a=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),s=1;s<arguments.length;s++){for(var u in r=Object(arguments[s]))n.call(r,u)&&(a[u]=r[u]);if(Object.getOwnPropertySymbols){i=Object.getOwnPropertySymbols(r);for(var c=0;c<i.length;c++)o.call(r,i[c])&&(a[i[c]]=r[i[c]])}}return a}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","g");return(0,o.default)(t,{stroke:(0,r.default)(e.color||"#f00"),strokeWidth:1}),e.rectangles.forEach(function(e){var n=document.createElementNS("http://www.w3.org/2000/svg","line");(0,o.default)(n,{x1:e.x,y1:e.y,x2:e.x+e.width,y2:e.y}),t.appendChild(n)}),t};var o=i(n(14)),r=i(n(15));function i(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){Object.keys(t).forEach(function(n){try{var o=r(n),i=t[n];"d"==o&&"Z"==i?console.log("Not valid"):e.setAttribute(n,i)}catch(o){console.log(o," with ",e,n,r(n),t[n])}})};var n=/[A-Z]/g,o=["viewBox"],r=function(e){return-1===o.indexOf(e)&&(e=e.replace(n,function(e){return"-"+e.toLowerCase()})),e};e.exports=t.default},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return n.test(e)&&(e="#"+e),e};var n=/^([a-f0-9]{6}|[a-f0-9]{3})$/i;e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=[],n=document.createElementNS("http://www.w3.org/2000/svg","path"),i=0,a=e.lines.length;i<a;i++){var s=e.lines[i],u=e.lines[i+1];s&&u&&(s.length>0&&u.length>0?3!=s.length&&u&&3!=u.length&&t.push("M"+s[0]+" "+s[1]+" "+u[0]+" "+u[1]):s.x&&s.y&&u.x&&u.y?t.push("M"+s.x+" "+s.y+" "+u.x+" "+u.y):console.log("Invalid senario",s.length,u.length,s,u))}return(0,o.default)(n,{d:t.join(" ")+"Z",stroke:(0,r.default)(e.color||"#000"),strokeWidth:e.width||1,fill:"none"}),n};var o=i(n(14)),r=i(n(15));function i(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=document.createElementNS("http://www.w3.org/2000/svg","svg"),o=document.createElementNS("http://www.w3.org/2000/svg","rect"),r=document.createElementNS("http://www.w3.org/2000/svg","path");return(0,i.default)(n,{width:a,height:a,x:0,y:.05*a*-1,viewBox:"0 0 1000 1000"}),(0,i.default)(o,{width:a,height:a,stroke:"#fff",fill:"#ff5"}),(0,i.default)(r,{d:s,strokeWidth:50,stroke:"#000",fill:"#fff"}),e.sub_type&&(0,i.default)(t,{width:28,height:25,x:e.x,y:e.y}),e.sub_type?t.innerHTML='<rect width="25" height="22" x="1.962286" y="1" style="fill:#ffff00;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-opacity:1" /> <rect width="18.4" height="1.5012145" x="5.8" y="5" style="fill:#000000;fill-opacity:1;stroke:none" /> <rect width="18" height="0.86" x="6" y="10" style="fill:#000000;fill-opacity:1;stroke:none" /> <rect width="18.4" height="0.86" x="5.8" y="14" style="fill:#000000;fill-opacity:1;stroke:none" /> <rect width="18" height="0.86" x="6" y="18" style="fill:#000000;fill-opacity:1;stroke:none" />':((0,i.default)(t,{width:a,height:a,x:e.x,y:e.y}),n.appendChild(r),t.appendChild(o),t.appendChild(n)),t};var o,r=n(14),i=(o=r)&&o.__esModule?o:{default:o},a=25,s="M499.968 214.336q-113.832 0 -212.877 38.781t-157.356 104.625 -58.311 142.29q0 62.496 39.897 119.133t112.437 97.929l48.546 27.9 -15.066 53.568q-13.392 50.778 -39.06 95.976 84.816 -35.154 153.45 -95.418l23.994 -21.204 31.806 3.348q38.502 4.464 72.54 4.464 113.832 0 212.877 -38.781t157.356 -104.625 58.311 -142.29 -58.311 -142.29 -157.356 -104.625 -212.877 -38.781z";e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"===p(Symbol.iterator)?function(e){return void 0===e?"undefined":p(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":void 0===e?"undefined":p(e)};t.default=function(e){if("highlight"!==e.type){var t=s(e);return(0,r.default)(t,{stroke:(0,i.default)(e.color||"#f00"),fill:"none"}),t}var n,a=(n=document.createElementNS("http://www.w3.org/2000/svg","g"),(0,r.default)(n,{fill:(0,i.default)(e.color||"#ff0"),fillOpacity:.2}),e.rectangles.forEach(function(e){n.appendChild(s(e))}),{v:n});if("object"===(void 0===a?"undefined":o(a)))return a.v};var r=a(n(14)),i=a(n(15));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){var t=document.createElementNS("http://www.w3.org/2000/svg","rect");return(0,r.default)(t,{x:e.x,y:e.y,width:e.width,height:e.height}),t}e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","text");return(0,o.default)(t,{x:e.x,y:e.y+parseInt(e.size,10),fill:(0,r.default)(e.color||"#000"),fontSize:e.size}),t.innerHTML=e.content,t};var o=i(n(14)),r=i(n(15));function i(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e=Array.isArray(e)?e:[],Object.keys(s).forEach(function(t){var n=s[t];e.filter(function(e){return e.type===t}).sort(n).forEach(function(e,t){return(0,o.default)(e,t+1)})})};var o=r(n(21));function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){return e.y<t.y?e.x-t.x:1}function a(e,t){return i(e.rectangles[0],t.rectangles[0])}(0,r(n(27)).default)();var s={highlight:a,strikeout:a,underline:a,drawing:function(e,t){var n=e.lines[0],o=t.lines[0];return i({x:n[0],y:n[1]},{x:o[0],y:o[1]})},textbox:i,point:i,area:i};e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1];switch(e.type){case"highlight":case"strikeout":case"underline":var n=e.rectangles,a=n[0],s=n[n.length-1];l=(0,o.default)("Begin "+e.type+" annotation "+t,e.uuid),(0,i.default)(l,a.x,a.y,e.page,!0),l=(0,o.default)("End "+e.type+" annotation "+t,e.uuid+"-end"),(0,i.default)(l,s.x+s.width,s.y,e.page,!1);break;case"textbox":case"point":var u="textbox"===e.type?" (content: "+e.content+")":"";l=(0,o.default)(e.type+" annotation "+t+u,e.uuid),(0,r.default)(l,e.x,e.y,e.page);break;case"drawing":case"area":var c=void 0!==e.x?e.x:e.lines[0][0],d=void 0!==e.y?e.y:e.lines[0][1];l=(0,o.default)("Unlabeled drawing",e.uuid),(0,r.default)(l,c,d,e.page)}};var o=a(n(22)),r=a(n(23)),i=a(n(24));function a(e){return e&&e.__esModule?e:{default:e}}a(n(25)),e.exports=t.default},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=document.createElement("div"),o=document.createTextNode(e);return n.appendChild(o),n.setAttribute("id","pdf-annotate-screenreader-"+t),n.style.position="absolute",n.style.left="-10000px",n.style.top="auto",n.style.width="1px",n.style.height="1px",n.style.overflow="hidden",n},e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o){if((0,i.default)(e,t,n,o,!0))return!0;var r=document.querySelector('svg[data-pdf-annotate-page="'+o+'"]'),s=r.getBoundingClientRect(),u=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(r.parentNode.querySelectorAll(".textLayer > div")));n=(0,a.scaleUp)(r,{y:n}).y+s.top,t=(0,a.scaleUp)(r,{x:t}).x+s.left;for(var c=0,d=u.length;c<d;c++){var l=u[c],f=l.getBoundingClientRect();if(n<=f.top)return l.parentNode.insertBefore(e,l),!0}var p=r.parentNode.querySelector(".textLayer");if(p){var v=p.getBoundingClientRect();if((0,a.pointIntersectsRect)(t,n,v))return p.appendChild(e),!0}return!1};var o,r=n(24),i=(o=r)&&o.__esModule?o:{default:o},a=n(6);e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,i){var a=function(e,t,n){var r=document.querySelector('svg[data-pdf-annotate-page="'+n+'"]'),i=r.getBoundingClientRect();return t=(0,o.scaleUp)(r,{y:t}).y+i.top,e=(0,o.scaleUp)(r,{x:e}).x+i.left,[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(r.parentNode.querySelectorAll(".textLayer [data-canvas-width]"))).filter(function(n){return(0,o.pointIntersectsRect)(e,t,n.getBoundingClientRect())})[0]}(t=Math.max(t+2*(i?1:-1),0),n+2,r);if(!a)return!1;t+=2*(i?-1:1);var s=document.querySelector('svg[data-pdf-annotate-page="'+r+'"]'),u=(0,o.scaleDown)(s,{left:a.getBoundingClientRect().left}).left-s.getBoundingClientRect().left,c=a.cloneNode(!0),d=c.innerHTML.split(""),l=[];for(c.style.position="absolute",c.style.top="-10000px",c.style.left="-10000px",document.body.appendChild(c);d.length;){if(">"===d[d.length-1])for(;d.length&&(l.unshift(d.pop()),"<"!==l[0]););c.innerHTML=d.join("");var f=(0,o.scaleDown)(s,{width:c.getBoundingClientRect().width}).width;if(u+f<=t)break;l.unshift(d.pop())}return a.innerHTML=d.join("")+e.outerHTML+l.join(""),c.parentNode.removeChild(c),!0};var o=n(6);e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){return(Array.isArray(n)?Promise.resolve(n):o.default.getStoreAdapter().getComments(e,t)).then(function(e){var n=document.getElementById("pdf-annotate-screenreader-"+t);if(n){var o=document.createElement("ol");o.setAttribute("id","pdf-annotate-screenreader-comment-list-"+t),o.setAttribute("aria-label","Comments"),n.appendChild(o),e.forEach(r.default)}})};var o=i(n(1)),r=i(n(26));function i(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(e){var t=document.querySelector("#pdf-annotate-screenreader-"+e.annotation+" ol");if(t){var n=document.createElement("li");n.setAttribute("id","pdf-annotate-screenreader-comment-"+e.uuid),n.appendChild(document.createTextNode(""+e.content)),t.appendChild(n)}}},e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){(0,a.addEventListener)("annotation:add",function(e,t,n){c(e,t,n.type)}),(0,a.addEventListener)("annotation:edit",function(e,t,n){c(e,n.page,n.type)}),(0,a.addEventListener)("annotation:delete",d),(0,a.addEventListener)("comment:add",l),(0,a.addEventListener)("comment:delete",f)},u(n(21));var o=u(n(20)),r=u(n(26)),i=u(n(25)),a=n(4),s=u(n(1));function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n){s.default.getStoreAdapter().getAnnotations(e,t).then(function(e){return e.annotations.filter(function(e){return e.type===n})}).then(function(e){return e.forEach(function(e){d(0,e.uuid)}),e}).then(o.default)}function d(e,t){p("pdf-annotate-screenreader-"+t),p("pdf-annotate-screenreader-"+t+"-end")}function l(e,t,n){var o=document.querySelector("pdf-annotate-screenreader-comment-list-"+t);(o?Promise.resolve(!0):(0,i.default)(e,t,[]).then(function(){return o=document.querySelector("pdf-annotate-screenreader-comment-list-"+t),!0})).then(function(){(0,r.default)(n)})}function f(e,t){p("pdf-annotate-screenreader-comment-"+t)}function p(e){var t=document.getElementById(e);t&&t.parentNode.removeChild(t)}e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),r=n(29),i=n(30),a=n(31),s=n(32),u=n(33),c=n(34);t.default={addEventListener:o.addEventListener,removeEventListener:o.removeEventListener,fireEvent:o.fireEvent,disableEdit:r.disableEdit,enableEdit:r.enableEdit,destroyEditOverlay:r.destroyEditOverlay,disablePen:i.disablePen,enablePen:i.enablePen,setPen:i.setPen,disablePoint:a.disablePoint,enablePoint:a.enablePoint,disableRect:s.disableRect,enableRect:s.enableRect,disableText:u.disableText,enableText:u.enableText,setText:u.setText,createPage:c.createPage,renderPage:c.renderPage,renderPageWithoutAnnotations:c.renderPageWithoutAnnotations},e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.enableEdit=function(e){e?y(e):c||(c=!0,(0,i.addEventListener)("annotation:click",E))},t.disableEdit=function(){g(),c&&(c=!1,(0,i.removeEventListener)("annotation:click",E))},t.destroyEditOverlay=g;var o=s(n(1)),r=s(n(11)),i=n(4),a=n(6);function s(e){return e&&e.__esModule?e:{default:e}}function u(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var c=!1,d=!1,l=void 0,f=void 0,p=void 0,v=void 0,m=void 0,h=3;function y(e){g(),l=document.createElement("div");var t=document.createElement("a"),n=(0,a.findSVGContainer)(e).parentNode,o=e.getAttribute("data-pdf-annotate-id"),r=(0,a.getAnnotationRect)(e),i=r.left-h,s=r.top-h;l.setAttribute("id","pdf-annotate-edit-overlay"),l.setAttribute("data-target-id",o),l.style.boxSizing="content-box",l.style.position="absolute",l.style.top=s+"px",l.style.left=i+"px",l.style.width=r.width+"px",l.style.height=r.height+"px",l.style.border=h+"px solid "+a.BORDER_COLOR,l.style.borderRadius=h+"px",t.innerHTML="",t.setAttribute("href","javascript://"),t.style.background="#fff",t.style.borderRadius="20px",t.style.border="1px solid #bbb",t.style.color="#bbb",t.style.fontSize="16px",t.style.padding="2px",t.style.textAlign="center",t.style.textDecoration="none",t.style.position="absolute",t.style.top="-13px",t.style.right="-13px",t.style.width="25px",t.style.height="25px",l.appendChild(t),n.appendChild(l),document.addEventListener("click",_),document.addEventListener("keyup",x),document.addEventListener("mousedown",S),t.addEventListener("click",b),t.addEventListener("mouseover",function(){t.style.color="#35A4DC",t.style.borderColor="#999",t.style.boxShadow="0 1px 1px #ccc"}),t.addEventListener("mouseout",function(){t.style.color="#bbb",t.style.borderColor="#bbb",t.style.boxShadow=""}),l.addEventListener("mouseover",function(){d||(t.style.display="")}),l.addEventListener("mouseout",function(){t.style.display="none"})}function g(){l&&(l.parentNode.removeChild(l),l=null),document.removeEventListener("click",_),document.removeEventListener("keyup",x),document.removeEventListener("mousedown",S),document.removeEventListener("mousemove",k),document.removeEventListener("mouseup",C),(0,a.enableUserSelect)()}function b(){if(l){var e=l.getAttribute("data-target-id"),t=document.querySelectorAll('[data-pdf-annotate-id="'+e+'"]'),n=l.parentNode.querySelector("svg.annotationLayer"),r=(0,a.getMetadata)(n).documentId,i=localStorage.getItem(r+"/annotations");if(i){var s=JSON.parse(i).filter(function(t){return t.uuid==e});if(s.length>0&&"point"==s[0].type&&!s[0].sub_type)return}[].concat(u(t)).forEach(function(e){e.parentNode.removeChild(e)}),o.default.getStoreAdapter().deleteAnnotation(r,e),g()}}function _(e){if((0,a.findSVGAtPoint)(e.clientX,e.clientY)){var t=document.getElementById("pdf-annotate-edit-overlay");if(t){if(d||e.target===t)return;g()}}}function x(e){l&&46===e.keyCode&&b()}var w=void 0;function S(e){if(e.target===l){var t=l.getAttribute("data-target-id"),n=document.querySelector('[data-pdf-annotate-id="'+t+'"]').getAttribute("data-pdf-annotate-type");if("highlight"!==n&&"strikeout"!==n&&"underline"!==n){d=!0,f=e.clientX,p=e.clientY,v=l.offsetLeft,m=l.offsetTop,l.style.background="rgba(255, 255, 255, 0.7)",l.style.cursor="move";var o=l.querySelector("a");o&&o.style&&(o.style.display="none"),document.addEventListener("mousemove",k),document.addEventListener("mouseup",C),(0,a.disableUserSelect)(),w=0!=(w=$('.new_comments_count[point_id="'+t+'"]')).length&&w[0]}}}function k(e){l.getAttribute("data-target-id");var t=l.parentNode.getBoundingClientRect(),n=m+(e.clientY-p),o=v+(e.clientX-f),r=t.height,i=t.width;n>0&&n+l.offsetHeight<r&&(l.style.top=n+"px",w&&(w.style.top=n-15+"px")),o>0&&o+l.offsetWidth<i&&(l.style.left=o+"px",w&&(w.style.left=o+20+"px"))}function C(e){var t=l.getAttribute("data-target-id"),n=document.querySelectorAll('[data-pdf-annotate-id="'+t+'"]'),i=n[0].getAttribute("data-pdf-annotate-type"),s=l.parentNode.querySelector("svg.annotationLayer"),c=(0,a.getMetadata)(s).documentId,f=l.querySelector("a");function p(e,t){return{deltaX:h+(0,a.scaleDown)(s,{x:l.offsetLeft}).x-e,deltaY:h+(0,a.scaleDown)(s,{y:l.offsetTop}).y-t}}f&&f.style&&(f.style.display=""),o.default.getStoreAdapter().getAnnotation(c,t).then(function(e){var d,l,f,v,m;["area","highlight","point","textbox"].indexOf(i)>-1?(d="x",l="y",f=p(parseInt(n[0].getAttribute(d),10),parseInt(n[0].getAttribute(l),10)),v=f.deltaX,m=f.deltaY,[].concat(u(n)).forEach(function(t,n){if(0!==m){var o=parseInt(t.getAttribute("y"),10)+m,r=o;"textbox"===i&&(r+=e.size),"point"===i&&(r=(0,a.scaleUp)(s,{viewY:r}).viewY),t.setAttribute("y",r),e.rectangles?e.rectangles[n].y=o:e.y&&(e.y=o)}if(0!==v){var u=parseInt(t.getAttribute("x"),10)+v,c=u;"point"===i&&(c=(0,a.scaleUp)(s,{viewX:c}).viewX),t.setAttribute("x",c),e.rectangles?e.rectangles[n].x=u:e.x&&(e.x=u)}})):"drawing"===i&&function(){var t=(0,a.scaleDown)(s,(0,a.getAnnotationRect)(n[0])),o=A(e.lines[0],2),i=o[0],u=o[1],c=p(i,u),d=c.deltaX,l=c.deltaY;l+=u-t.top,d+=i-t.left,e.lines.forEach(function(t,n){var o=A(e.lines[n],2),r=o[0],i=o[1];e.lines[n][0]=r+d,e.lines[n][1]=i+l}),n[0].parentNode.removeChild(n[0]),(0,r.default)(s,e)}(),o.default.getStoreAdapter().editAnnotation(c,t,e)}),setTimeout(function(){d=!1},0),l.style.background="",l.style.cursor="",document.removeEventListener("mousemove",k),document.removeEventListener("mouseup",C),(0,a.enableUserSelect)()}function E(e){y(e)}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.setPen=function(){var e=arguments.length<=0||void 0===arguments[0]?1:arguments[0],t=arguments.length<=1||void 0===arguments[1]?"000000":arguments[1];u=parseInt(e,10),c=t},t.enablePen=function(){s||(is_mobile_device&&$("body").css("overflow","hidden"),s=!0,document.addEventListener("mousedown",f),document.addEventListener("touchstart",f),(0,i.disableUserSelect)())},t.disablePen=function(){s&&(s=!1,document.removeEventListener("mousedown",f),document.removeEventListener("touchstart",f),(0,i.enableUserSelect)())};var o=a(n(1)),r=a(n(11)),i=n(6);function a(e){return e&&e.__esModule?e:{default:e}}var s=!1,u=void 0,c=void 0,d=void 0,l=void 0;function f(e){is_mobile_device&&$("body").css("overflow","hidden"),d=null,l=[],document.addEventListener("mousemove",v),document.addEventListener("mouseup",p),document.addEventListener("touchmove",v,{passive:!1}),document.addEventListener("touchend",p)}function p(e){e.changedTouches&&(e=e.changedTouches[0]);var t=void 0;if(l.length>1&&(t=(0,i.findSVGAtPoint)(e.clientX,e.clientY))){var n=(0,i.getMetadata)(t),a=n.documentId,s=n.pageNumber;l[l.length-1].push(-1),o.default.getStoreAdapter().addAnnotation(a,s,{type:"drawing",width:u,color:c,lines:l}).then(function(e){d&&t.removeChild(d),(0,r.default)(t,e)})}document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",p),document.removeEventListener("touchmove",v),document.removeEventListener("touchend",p),is_mobile_device&&$("body").css("overflow","auto")}function v(e){e.preventDefault(),e.touches&&(e=e.touches[0]),function(e,t){var n=(0,i.findSVGAtPoint)(e,t);if(n){var o=n.getBoundingClientRect(),a=(0,i.scaleDown)(n,{x:e-o.left,y:t-o.top});l.push([a.x,a.y]),l.length<=1||(d&&n.removeChild(d),d=(0,r.default)(n,{type:"drawing",color:c,width:u,lines:l}))}}(e.clientX,e.clientY)}},function(t,n,o){Object.defineProperty(n,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"===p(Symbol.iterator)?function(e){return void 0===e?"undefined":p(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":void 0===e?"undefined":p(e)};n.enablePoint=function(){l||(l=!0,document.addEventListener("mouseup",v))},n.disablePoint=function(){l&&(l=!1,document.removeEventListener("mouseup",v))};var a=d(o(1)),s=d(o(11)),u=o(6);function d(e){return e&&e.__esModule?e:{default:e}}var l=!1,f=void 0;function v(e){!f&&(0,u.findSVGAtPoint)(e.clientX,e.clientY)&&((f=document.createElement("input")).setAttribute("id","pdf-annotate-point-input"),f.setAttribute("placeholder","Enter comment"),f.style.border="3px solid "+u.BORDER_COLOR,f.style.borderRadius="3px",f.style.position="fixed",f.style.top=e.clientY+"px",f.style.left=e.clientX+"px",f.addEventListener("blur",m),f.addEventListener("keyup",h),document.body.appendChild(f),f.focus())}function m(){y()}function h(e){27===e.keyCode?g():13===e.keyCode&&y()}function y(){if(0!=f.value.trim().length){if(f.value.trim().length>0){var t=function(){var t=parseInt(f.style.left,10),n=parseInt(f.style.top,10),o=f.value.trim(),r=(0,u.findSVGAtPoint)(t,n);if(!r)return{v:void 0};var d=r.getBoundingClientRect(),l=(0,u.getMetadata)(r),p=l.documentId,v=l.pageNumber,m=Object.assign({type:"point"},(0,u.scaleDown)(r,{x:t-d.left,y:n-d.top})),h=a.default.getStoreAdapter();m.sub_type=i,m.counter=0,h.addAnnotation(p,v,m).then(function(t){var n={content:o,date_time:new Date,uid:e.id,user_name:e.name};h.addComment(p,t.uuid,n),(0,s.default)(r,t);var i=t.uuid,a=$("select.scale").val(),u="<div point_id="+t.uuid+' class="new_comments_count"';u+=' comment_count="0" style="top:'+(t.y*a-15)+"px;left:"+(t.x*a+15)+'px;;display:none;">0</div>',u=$(u),$("#pageContainer"+v+" .canvasWrapper").append(u),c(i)})}();if("object"===(void 0===t?"undefined":r(t)))return t.v}g()}else g()}function g(){f.removeEventListener("blur",m),f.removeEventListener("keyup",h),document.body.removeChild(f),f=null}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.enableRect=function(e){c=e,u||(u=!0,document.addEventListener("mouseup",y),document.addEventListener("mousedown",p),document.addEventListener("keyup",m),y(e))},t.disableRect=function(){u&&(u=!1,document.removeEventListener("mouseup",y),document.removeEventListener("mousedown",p),document.removeEventListener("keyup",m))};var o=a(n(1)),r=a(n(11)),i=n(6);function a(e){return e&&e.__esModule?e:{default:e}}function s(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var u=!1,c=void 0,d=void 0,l=void 0,f=void 0;function p(e){var t=void 0;if("area"===c&&(t=(0,i.findSVGAtPoint)(e.clientX,e.clientY))){var n=t.getBoundingClientRect();l=e.clientY,f=e.clientX,(d=document.createElement("div")).style.position="absolute",d.style.top=l-n.top+"px",d.style.left=f-n.left+"px",d.style.border="3px solid "+i.BORDER_COLOR,d.style.borderRadius="3px",t.parentNode.appendChild(d),document.addEventListener("mousemove",v),(0,i.disableUserSelect)()}}function v(e){var t=d.parentNode.querySelector("svg.annotationLayer").getBoundingClientRect();f+(e.clientX-f)<t.right&&(d.style.width=e.clientX-f+"px"),l+(e.clientY-l)<t.bottom&&(d.style.height=e.clientY-l+"px")}function m(e){27===e.keyCode&&(window.getSelection().removeAllRanges(),d&&d.parentNode&&(d.parentNode.removeChild(d),d=null,document.removeEventListener("mousemove",v)))}function h(e,t,n){var a=(0,i.findSVGAtPoint)(t[0].left,t[0].top),u=void 0;if(a){var c=a.getBoundingClientRect();if(n||("highlight"===e?n="FFFF00":"strikeout"===e?n="FF0000":"underline"===e&&(n="00FF00")),0!==(u={type:e,color:n,rectangles:[].concat(s(t)).map(function(t){var n=0;return"strikeout"===e?n=t.height/2:"underline"===e&&(n=t.height-2),(0,i.scaleDown)(a,{y:t.top+n-c.top,x:t.left-c.left,width:t.width,height:t.height})}).filter(function(e){return e.width>0&&e.height>0&&e.x>-1&&e.y>-1})}).rectangles.length){if("area"===e){var d=u.rectangles[0];delete u.rectangles,u.x=d.x,u.y=d.y,u.width=d.width,u.height=d.height}var l=(0,i.getMetadata)(a),f=l.documentId,p=l.pageNumber;o.default.getStoreAdapter().addAnnotation(f,p,u).then(function(e){(0,r.default)(a,e)})}}}function y(e){if("string"==typeof e){var t=void 0;if("area"!==(c=e)&&(t=function(){try{var e=window.getSelection().getRangeAt(0).getClientRects();if(e.length>0&&e[0].width>0&&e[0].height>0)return e}catch(e){}return null}())){(0,i.findSVGAtPoint)(t[0].left,t[0].top);var n=s(t),o=(n=[].concat(n)).map(function(e){return{top:e.top,left:e.left,width:e.width,height:e.height}});h(c,o)}else if("area"===c&&d){var r=d.parentNode.querySelector("svg.annotationLayer").getBoundingClientRect();h(c,[{top:parseInt(d.style.top,10)+r.top,left:parseInt(d.style.left,10)+r.left,width:parseInt(d.style.width,10),height:parseInt(d.style.height,10)}]),d.parentNode.removeChild(d),d=null,document.removeEventListener("mousemove",v),(0,i.enableUserSelect)()}}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"===p(Symbol.iterator)?function(e){return void 0===e?"undefined":p(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":void 0===e?"undefined":p(e)};t.setText=function(){var e=arguments.length<=0||void 0===arguments[0]?12:arguments[0],t=arguments.length<=1||void 0===arguments[1]?"000000":arguments[1];d=parseInt(e,10),l=t},t.enableText=function(){u||(u=!0,document.addEventListener("mouseup",f))},t.disableText=function(){u&&(u=!1,document.removeEventListener("mouseup",f))};var r=s(n(1)),i=s(n(11)),a=n(6);function s(e){return e&&e.__esModule?e:{default:e}}var u=!1,c=void 0,d=void 0,l=void 0;function f(e){!c&&(0,a.findSVGAtPoint)(e.clientX,e.clientY)&&((c=document.createElement("input")).setAttribute("id","pdf-annotate-text-input"),c.setAttribute("placeholder","Enter text"),c.style.border="3px solid "+a.BORDER_COLOR,c.style.borderRadius="3px",c.style.position="absolute",c.style.top=e.clientY+"px",c.style.left=e.clientX+"px",c.style.fontSize=d+"px",c.addEventListener("blur",v),c.addEventListener("keyup",m),document.body.appendChild(c),c.focus())}function v(){h()}function m(e){27===e.keyCode?y():13===e.keyCode&&h()}function h(){if(c.value.trim().length>0){var e=function(){var e=parseInt(c.style.left,10),t=parseInt(c.style.top,10),n=(0,a.findSVGAtPoint)(e,t);if(!n)return{v:void 0};var o=(0,a.getMetadata)(n),s=o.documentId,u=o.pageNumber,f=n.getBoundingClientRect(),p=Object.assign({type:"textbox",size:d,color:l,content:c.value.trim()},(0,a.scaleDown)(n,{x:e-f.left,y:t-f.top,width:c.offsetWidth,height:c.offsetHeight}));r.default.getStoreAdapter().addAnnotation(s,u,p).then(function(e){(0,i.default)(n,e)})}();if("object"===(void 0===e?"undefined":o(e)))return e.v}y()}function y(){c&&(c.removeEventListener("blur",v),c.removeEventListener("keyup",m),document.body.removeChild(c),c=null)}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);o=!0);}catch(e){r=!0,i=e}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};t.createPage=function(e){var t=document.createElement("div");t.innerHTML=s;var n=t.children[0],o=n.querySelector("canvas");return n.setAttribute("id","pageContainer"+e),n.setAttribute("data-page-number",e),o.mozOpaque=!0,o.setAttribute("id","page"+e),n},t.renderPage=function(e,t,n){var a=t.documentId,s=t.pdfDocument,c=t.scale,d=t.rotate,l=s.getPage(e),f=r.default.getAnnotations(a,e),p=[l,f];return Promise.all(p).then(function(t){var a=o(t,2),s=a[0],l=a[1],f=document.getElementById("pageContainer"+e),p=f.querySelector(".annotationLayer"),v=f.querySelector(".canvasWrapper canvas"),m=v.getContext("2d",{alpha:!1}),h=s.getViewport(c,d),y=u(e,h,m),g=s.render({canvasContext:m,viewport:h,transform:y}),b=r.default.render(p,h,l);return Promise.all([g,b]).then(function(){return s.getTextContent({normalizeWhitespace:!0}).then(function(t){return new Promise(function(n,o){var r=f.querySelector(".textLayer"),a=new PDFJS.DefaultTextLayerFactory,s=a.createTextLayerBuilder(r,e-1,h);s.setTextContent(t),s.render(),setTimeout(function(){try{(0,i.default)(l.annotations),n()}catch(e){o(e)}})})})}).then(function(){return f.setAttribute("data-loaded","true"),n&&n(l.annotations,e),[s,l]})})},t.renderPageWithoutAnnotations=function(e,t,n){t.documentId;var a=t.pdfDocument,s=t.scale,c=t.rotate,d=[a.getPage(e),[]];return Promise.all(d).then(function(t){var a=o(t,2),d=a[0],l=[],f=document.getElementById("pageContainer"+e),p=f.querySelector(".annotationLayer"),v=f.querySelector(".canvasWrapper canvas"),m=v.getContext("2d",{alpha:!1}),h=d.getViewport(s,c),y=u(e,h,m),g=d.render({canvasContext:m,viewport:h,transform:y}),b=r.default.render(p,h,l);return Promise.all([g,b]).then(function(){return d.getTextContent({normalizeWhitespace:!0}).then(function(t){return new Promise(function(o,r){var a=f.querySelector(".textLayer"),s=new PDFJS.DefaultTextLayerFactory,u=s.createTextLayerBuilder(a,e-1,h);u.setTextContent(t),u.render(),setTimeout(function(){try{(0,i.default)(l.annotations),n&&n(),o()}catch(e){r(e)}})})})}).then(function(){return f.setAttribute("data-loaded","true"),[d,l]})})};var r=a(n(1)),i=a(n(20));function a(e){return e&&e.__esModule?e:{default:e}}var s='\n  <div style="visibility: hidden;" class="page" data-loaded="false">\n    <div class="canvasWrapper">\n      <canvas></canvas>\n    </div>\n    <svg class="annotationLayer"></svg>\n    <div class="textLayer"></div>\n  </div>\n';function u(e,t,n){var o,r,i,a,s=document.getElementById("pageContainer"+e),u=s.querySelector(".canvasWrapper canvas"),l=s.querySelector(".annotationLayer"),f=s.querySelector(".canvasWrapper"),p=s.querySelector(".textLayer"),v=(o=n,r=window.devicePixelRatio||1,i=o.webkitBackingStorePixelRatio||o.mozBackingStorePixelRatio||o.msBackingStorePixelRatio||o.oBackingStorePixelRatio||o.backingStorePixelRatio||1,{sx:a=r/i,sy:a,scaled:1!==a}),m=v.scaled?[v.sx,0,0,v.sy,0,0]:null,h=c(v.sx),y=c(v.sy);return s.style.visibility="",u.width=d(t.width*v.sx,h[0]),u.height=d(t.height*v.sy,y[0]),u.style.width=d(t.width,h[1])+"px",u.style.height=d(t.height,h[1])+"px",l.setAttribute("width",t.width),l.setAttribute("height",t.height),l.style.width=t.width+"px",l.style.height=t.height+"px",s.style.width="100%",s.style.height=t.height+"px",f.style.width=t.width+"px",f.style.height=t.height+"px",p.style.width="100%",p.style.height=t.height+"px",$("#viewer").width(t.width),m}function c(e){if(Math.floor(e)===e)return[e,1];var t=1/e;if(t>8)return[1,8];if(Math.floor(t)===t)return[1,t];for(var n=e>1?t:e,o=0,r=1,i=1,a=1;;){var s=o+i,u=r+a;if(u>8)break;n<=s/u?(i=s,a=u):(o=s,r=u)}return n-o/r<i/a-n?n===e?[o,r]:[r,o]:n===e?[i,a]:[a,i]}function d(e,t){var n=e%t;return 0===n?e:Math.round(e-n+t)}}])},"object"===p(o)&&"object"===p(t)?t.exports=r():(u=[],void 0===(d="function"==typeof(a=r)?a.apply(o,u):a)||(t.exports=d))}).call(o,r(3)(t))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){function r(e){var t=arguments.length<=1||void 0===arguments[1]||arguments[1];d.setAttribute("data-color",e),d.style.background=e,t&&"function"==typeof o&&o(e),i()}function i(){document.removeEventListener("keyup",s),u&&u.parentNode&&u.parentNode.removeChild(u),c=!1,d.focus()}function a(e){var t=document.createElement("a");return t.className="color",t.setAttribute("href","javascript://"),t.setAttribute("title",e.name),t.setAttribute("data-color",e.hex),t.style.background=e.hex,t}function s(e){27===e.keyCode&&i()}var u=void 0,c=!1,d=a({hex:t});d.onclick=function(){c?i():(u||((u=document.createElement("div")).style.background="#fff",u.style.border="1px solid #ccc",u.style.padding="2px",u.style.position="absolute",u.style.width="122px",e.style.position="relative",n.map(a).forEach(function(e){e.style.margin="2px",e.onclick=function(){r(e.getAttribute("data-color"))},u.appendChild(e)})),document.addEventListener("keyup",s),e.appendChild(u),c=!0)},r(t,!1)};var n=[{hex:"#000000",name:"Black"},{hex:"#EF4437",name:"Red"},{hex:"#E71F63",name:"Pink"},{hex:"#8F3E97",name:"Purple"},{hex:"#65499D",name:"Deep Purple"},{hex:"#4554A4",name:"Indigo"},{hex:"#2083C5",name:"Blue"},{hex:"#35A4DC",name:"Light Blue"},{hex:"#09BCD3",name:"Cyan"},{hex:"#009688",name:"Teal"},{hex:"#43A047",name:"Green"},{hex:"#8BC34A",name:"Light Green"},{hex:"#FDC010",name:"Yellow"},{hex:"#F8971C",name:"Orange"},{hex:"#F0592B",name:"Deep Orange"},{hex:"#F06291",name:"Light Pink"}]}]);window.pdf_js_module=S}();