!function(){var R,D,B,q=0,F=[],z=!1,U=!1,W=!1,Y=!1,X=!1,J=!1,V=void 0,G=void 0,H=void 0,Z=void 0,K=void 0,Q=void 0,ee=void 0,te=void 0,ne=void 0,oe=function(){console.log("Load comment not defined")},re=function(){console.log("Save annotation not defined")},ie=function(){console.log("onAnnotationsDownloaded not defined")};function ae(){$(".topbar:first .cursor:first").click()}function se(e){var t=fe(e,e+"/version");return isNaN(t)&&bootbox.alert("Cookie1 must have been se, plz contact support"),t}function ue(e){var t=fe(e,e+"/dirty");return isNaN(t)&&bootbox.alert("Cookie2 must have been set for "+e+", plz contact support"),t}function de(e){if(1!=ue(e)){var t=fe(e,e+"/version");t+=1,localStorage.setItem(e+"/version",t),localStorage.setItem(e+"/dirty",1)}}function ce(e){localStorage.setItem(e+"/dirty",0)}function le(e,t){localStorage.setItem(e+"/version",t)}function fe(e,t){r(e,t);var n=localStorage.getItem(t);return isNaN(n)||(n=parseFloat(n)),n}function pe(e,t,n){var o=r(e,t);"dirty"!=o&&"version"!=o||(bootbox.alert("Should not happend"),console.trace()),localStorage.setItem(t,n)}function r(e,t){var n=t.replace(e+"/","");return-1==["version","annotations","dirty","scale","rotate","pen/size","pen/color","text/size","text/color"].indexOf(n)&&(console.trace(),bootbox.alert("Please report this issue2 with "+t+" for "+e)),n}function ve(){D&&0<D.length&&($("#annotated-doc-conatiner").hide(),z=!1,D.hide(),$(".router-outlet").show(),re("Leaving"))}$(function(){var i=!1;$(document).on("mouseup","#viewer",function(r){2!=r.button&&1==q&&setTimeout(function(){var e=window.getSelection();if(1!=q||"Range"!=e.type||0==e.baseOffset&&0==e.focusOffset){var t=$(".toolbar .pen").hasClass("active"),n=$(".toolbar .cursor").hasClass("active");$(".toolbar .comment").hasClass("active")?i=!!i:t||n||ae()}else{var o=$(".annotation-options.ContextMenuPopup");o.css({left:r.pageX-o.width()/2,top:r.clientY+12}).show(),Y=!0}},10)})});var n,o,e=(o={},i.m=n=[function(e,t,n){try{var o,r,l,i=s(n(2)),a=(s(n(4)),function(){}),f=void 0,p=!1;$(document).height(),$(document).width();window.init_doc_comments=function(){(D=$("#comment-wrapper")).resizable(),o=D.find("#commentText"),r=D.find(".comment-list:first"),l=D.find(".comment-list-container:first"),o.focus(function(){J=!0}),ae(),$(window).unbind("unload",ve),$(window).bind("unload",ve),B=$("#content-wrapper")},R=localStorage.getItem("user"),R=JSON.parse(R);var v=!1;function s(e){return e&&e.__esModule?e:{default:e}}var m=i.default.UI,h={};i.default.setStoreAdapter(new i.default.LocalStoreAdapter);var d=0,c=void 0,g=i.default.getStoreAdapter();N="",ie=function(t,n){var o=t.comments;Array.isArray(o)||(o=[],console.log("Why not comments"));var e=se(p);t.annotations||(t.annotations=[]);var r=void 0,i=ue(p);t.version>e?1==i?(r="Document annotation version="+t.version+" available from server,",r+="<br>You have older version="+e+" at local.",r+="<br>If you download, it will discard your recent changes,",r+="<br>Do you still want to download?",bootbox.confirm(r,function(e){j(e?t.annotations:[],t.version,o,n)})):j(t.annotations,t.version,o,n):j([],t.version,o,n)},re=function(e){if(a(1),p){if(1==ue(p)){var t=se(p),n={id:doc_id,doc_id:p};if(delete n.reset,"reset"==e)n.reset=1;else{var o=localStorage.getItem(p+"/annotations");if(!o||"[]"==o)return void console.log("No annotations");0==t&&(de(p),le(p,1)),n.annotations=o,n.version=t}dn_rpc_object({data:{args:{app:"documents",model:"AnnotationDocument",method:"add_annotation"},params:n},no_loader:1,onSuccess:function(e){!function(t){if("done"!=t){if(isNaN(t))return bootbox.alert("Could not save:"),console.log(t);var n=se(p);N="Server already has version="+t,N+="<br>Do you want to overwrite server version with local="+n+"?",bootbox.confirm(N,function(e){e&&(le(n=t+1),re())})}else ce(p),console.log("Saved")}(e)},onError:T,type:"post"})}}else console.log("saveAnnotationsAtServer must be called after document id is set")},window.saveAnnotationsAtServer=re,$("body").on("click",".doc-saver",function(){re()}),$("body").on("click",".cb-container.autosave input",function(){$(this).prop("checked")&&re()}),$("body").on("click",".toolbar .back",function(){ve()}),$("body").on("click",".doc-reseter",function(){N="Do you want to erase all annotations on document.",N+="<br>Warning: It will also reset.",bootbox.confirm(N,function(e){if(e){var t=localStorage.getItem(p+"/annotations");t=(t=JSON.parse(t)).filter(function(e){return"point"==e.type&&!e.sub_type}),t=JSON.stringify(t),localStorage.removeItem(p+"/annotations"),localStorage.setItem(p+"/annotations",t),de(p),re("reset")}})}),$("body").on("click",".ContextMenuPopup.toolbar:first .copy:first",function(){document.execCommand("copy"),$(this).parent().parent().hide()}),$(document).mousedown(function(e){if(2!=e.button){var t=$(e.target);if(J)0==t.closest("#comment-wrapper").length&&(J=!1,oe());if(!Y||t.is(".ContextMenuPopup button")||t.is(".ContextMenuPopup .colored")||$(".ContextMenuPopup").hide(),$(".topbar:first .pen:first").hasClass("active"))0<F.length&&0==t.closest("#viewer").length&&a();else if($(".pdfViewer").css("cursor","default"),f&&0==t.closest("#comment-wrapper").length)f=void 0,$(".comment-list-form").hide();else $(".toolbar .comment").hasClass("active")&&0==t.closest("#viewer").length&&ae()}}),$("body").on("click",".cell.colored",function(){var t=$(this),e=t.attr("hex").substring(1);H?H.color!=e&&(H.color=e,g.editAnnotation(p,G,H).then(function(e){t.append($("#applied_color").show())})):($(".topbar .pen-color:first").css("background",e),$(".topbar .pen-color:first").attr("color",e),y(null,e),t.append($("#applied_color").show()))}),$(".notification-list:first").on("click, li.list-group-item contact",function(){console.log(1344)});var y=function(e,t){},b="top",_="left",w=void 0;function x(e,t){e=e.filter(function(e){return"point"==e.type&&!e.sub_type});for(var n in e){var o=e[n],r="<div db_id="+o.id+" point_id="+o.uuid+' class="new_comments_count"',i=o.y*w-15,a=o.x*w+15,s=b+":"+i+"px;"+(_+":"+a+"px;");0==o.counter&&(s+="display:none;"),r+=' style="'+s+'" comment_count="'+o.counter+'">'+o.counter+"</div>",$("#pageContainer"+t+" .canvasWrapper").append(r)}}function A(){D.hide(),z=!1,localStorage.removeItem(p+"/shown_comment_type")}function C(e){e&&(U=e),"notes"==U?D.find(".title:first").html("Personal Notes"):D.find(".title:first").html("Comments"),D.show(),f?$(".comment-list-form").show():$(".comment-list-form").hide(),z=U;$(".comment-header").offset().top;try{parseInt(l.css("padding-bottom"))}catch(e){}var t=B.offset().top;B.height(window.innerHeight-t),localStorage.setItem(p+"/shown_comment_type",z)}function S(){var e=fe(p,p+"/annotations");return e=e?JSON.parse(e):[]}function k(){o.html(""),o.parent().show(),r.scrollTop(999999e3),o.focus()}function E(e){e.counter=0,L(e,0)}function L(e,t,n){var o=fe(p,p+"/annotations");for(var r in o=o?JSON.parse(o):[])if(o[r].uuid==e.uuid){var i=0;if(0!=t&&(i=t,o[r].counter&&(i+=o[r].counter)),e.counter=i,o[r].counter=i,!n){var a=$('.new_comments_count[point_id="'+e.uuid+'"]');0==i?a.hide():a.show(),a.html(i).attr("comment_count",i)}localStorage.setItem(p+"/annotations",JSON.stringify(o));break}}function P(e){if(R=window.current_user.cookie,site_functions.hideLoader("Document Data"),ne="Document Render Data",site_functions.showLoader(ne),e&&e.first_time)if(D=$("#comment-wrapper"),o=D.find("#commentText"),r=D.find(".comment-list:first"),l=D.find(".comment-list-container:first"),X=e.type+"-"+e.id+".pdf",p=e.type+"-"+e.id+"-"+R.id+".pdf",doc_id=e.id,h.documentId=p,v=!1,localStorage.getItem(p+"/dirty")||function(e){localStorage.setItem(e+"/version",0),localStorage.setItem(e+"/scale",1),localStorage.setItem(e+"/roate",0),localStorage.setItem(e+"/dirty",0),localStorage.setItem(e+"/annotations","[]")}(p),"meeting"==e.type||"topic"==e.type){se(p);u(e)}else u(e);else setTimeout(u,100)}function u(a){try{var e=B.offset().top;B.height(window.innerHeight-e);if(a&&a.first_time){try{"meeting"==a.type||"topic"==a.type?window.show_annotation=!0:window.show_annotation=!1,$(".topbar:first .annotation_button").hide(),B.hide(),$(".strt_sign.pdfjs").hide(),$(".sign_completed.pdfjs").hide(),$(".router-outlet").hide(),$(".doc-reseter").hide(),$(".toolbar.topbar:first").show(),$("#annotated-doc-conatiner").show(),A(),function(){function e(e,t){e=parseFloat(e,10),t=parseInt(t,10);var n=$("#viewer").width();if(e/h.scale*n,h.scale!==e||h.rotate!==t){h.scale=e,h.rotate=t,pe(h.documentId,h.documentId+"/scale",h.scale);fe(h.documentId,h.documentId+"/scale");pe(h.documentId,h.documentId+"/rotate",h.rotate%360),P()}}var t=document.querySelector(".toolbar select.scale");function n(){e(t.value,h.rotate)}t.addEventListener("change",n),document.querySelector(".toolbar .rotate-ccw").addEventListener("click",function(){e(h.scale,h.rotate-90)}),document.querySelector(".toolbar .rotate-cw").addEventListener("click",function(){e(h.scale,h.rotate+90)}),$("body").on("click",".toolbar:first .zoomin",function(){if(!(5<=h.scale)){var e=t.children[t.selectedIndex];t.value=$(e).next().val(),n()}}),$("body").on("click",".toolbar:first .zoomout",function(){if(!(h.scale<=.25)){var e=t.children[t.selectedIndex];t.value=$(e).prev().val(),n()}})}();var t=$(".toolbar select.scale:first");(h={documentId:p,scale:fe(p,p+"/scale"),rotate:fe(p,p+"/rotate"),pdfDocument:null}).rotate||(h.rotate=360,pe(p,p+"/rotate",360)),h.scale||(h.scale=1,pe(p,p+"/scale",1)),t.val(h.scale);var n=B.prev()[0].getBoundingClientRect().bottom;B.height(window.innerHeight-40-n)}catch(e){console.log(e)}if(!a.type)return bootbox.alert("Invalid document data ",a),void site_functions.hideLoader(ne);try{if(a.url)if(-1<window.location.toString().indexOf("4200"))a.doc=site_config.site_url+"/static/assets/a.pdf";else{var o=window.site_config.server_base_url+a.url;console.log(window.site_config.server_base_url,a.url,o),a.doc=o}else{a.doc.startsWith("data:application/pdf;base64,")&&(a.doc=a.doc.replace("data:application/pdf;base64,",""));for(var r=atob(a.doc),i=new Uint8Array(r.length),s=0;s<r.length;s++)i[s]=r.charCodeAt(s);a.doc=i}h.document_data=a,site_functions.hideLoader(ne),ne="document content",site_functions.showLoader(ne),PDFJS.getDocument(a.doc).then(function(e){console.log(Date(),(new Date).getMilliseconds(),"got doc data at client to show"),c=e,$(".page-count").html(c.numPages),1<c.numPages&&$(".page-next-btn").removeAttr("disabled"),site_functions.hideLoader(ne),ne="document pages",site_functions.showLoader(ne),u(c)})}catch(e){console.log(e)}}else{if(!h.document_data)return bootbox.alert("Invalid render options data ",h),void site_functions.hideLoader(ne);h.document_data.doc,p=h.documentId,u(c)}function u(e){try{if(!e)return alert("PDF not loaded"),void site_functions.hideLoader(ne);h.pdfDocument=e;var t=document.getElementById("viewer");t.innerHTML="",d=e.pdfInfo.numPages;for(var n=0;n<d;n++){var o=m.createPage(n+1);t.appendChild(o)}w=$("select.scale").val();var r=h.rotate%360;switch(function(e){var t=h.document_data,n=t.type;if(0!=e||"meeting"!=n&&"topic"!=n)q=0,$(".annot-toggler").hide(),"meeting"!=n&&"topic"!=n||(q=2),h.showAnnotations=!1,$(".topbar:first .annotation_button").hide(),"signature"==t.type&&($(".strt_sign").attr("doc_id",t.id),"Pending"==t.mp_signature_status&&($(".sign_completed.pdfjs").hide(),$(".strt_sign.pdfjs").show()),"Completed"==t.mp_signature_status&&($(".strt_sign.pdfjs").hide(),$(".sign_completed.pdfjs").show()));else{q=1,h.showAnnotations=!0;var o=fe(h.documentId,h.documentId+"/pen/size")||1,r=fe(h.documentId,h.documentId+"/pen/color")||"#000000";y(o,r),$(".topbar:first .annotation_button").show(),$(".annot-toggler").show()}}(r),r){case 90:b="right",_="top";break;case 180:b="bottom",_="right";break;case 270:b="left",_="bottom"}}catch(e){console.log(e)}function i(e,t){try{0,1==t&&(first_page_rendered=1,a&&a.first_time&&$("body").addClass("pdf-viewer"),B.show(),console.log(Date(),(new Date).getMilliseconds(),"first page done")),1==q&&x(e,t),t==d&&(function(){try{if(site_functions.hideLoader(ne),document_version=se(p),!a||!a.first_time)return;var e=window.socket_manager,t=(doc_id,document_version);t={args:{app:"documents",model:"AnnotationDocument",method:"get_annotations"},no_loader:1,params:{id:doc_id,doc_id:p,version:document_version}};dn_rpc_object({data:t,no_loader:1,onSuccess:function(e){a.first_time=void 0,ie(e,a)},onError:function(e){console.log(e)}}),e.execute_on_verified(function(){var a=e.notificationList;$(".canvasWrapper .new_comments_count").each(function(e,t){var n="documents",o="PointAnnotation",r=parseInt($(t).attr("db_id"));for(var i in a)a[i].address.res_app==n&&a[i].address.res_model==o&&a[i].address.res_id==r&&(console.log(e,i,a[i].count,134),$(t).attr("counter",$(t).attr("counter")+a[i].count))})})}catch(e){console.log(e)}}(),console.log(Date(),(new Date).getMilliseconds(),"document done"))}catch(e){console.log(e)}}try{m.renderPage(1,h,function(e,t){i(e,t);for(var n=2;n<=d;n++)m.renderPage(n,h,function(e,t){i(e,t)})})}catch(e){console.log(e)}}window.show_annotation?($(".annotationLayer").show(),$(".annotation_button").show()):($(".annotationLayer").hide(),$(".annotation_button").hide())}catch(e){console.log(e)}}a=function(e){if(0<F.length){var t=fe(p,p+"/annotations");t=JSON.parse(t);var n=F[0];t=t.filter(function(e){return 1!=e.to_merge});for(var o=1;o<F.length;o++)n.lines=n.lines.concat(F[o].lines);n.to_merge=0,t.push(n),localStorage.setItem(p+"/annotations",JSON.stringify(t)),F=[],n={},e||u()}},M=O=void 0,y=function(e,t){var n=!1;e&&"number"!=typeof e&&(e=parseInt(e)),t&&6==t.length&&(t="#"+t),e&&O!==e&&(n=!0,O=e,pe(h.documentId,h.documentId+"/pen/size",O),document.querySelector(".toolbar .pen-size").value=O),t&&M!==t&&(n=!0,M=t,pe(h.documentId,h.documentId+"/pen/color",M),$(".toolbar .pen-color:first").css("background-color",M),$(".toolbar .pen-color:first").attr("color",t),$("select.pen-size").css("color",t),$("select.pen-size option").css("color",t)),n&&m.setPen(O,M)},$("body").on("click",".toolbar .pen-color:first",function(e){var t=$(".topbar:first").width(),n=$(".ColorPalettePopup:first"),o=this.getBoundingClientRect(),r={top:o.y+20};t/2>o.x?r.left=o.x:r.left=o.x-n.width(),n.css(r).show();var i=$(this).attr("color");n.find('div[hex="'+i+'"]:first').click()}),$("body").on("change",".toolbar .pen-size:first",function(e){y(e.target.value,M)}),I="cursor",$("body").on("click",".toolbar.topbar:first button, .toolbar.annotation-options:first button",function(e){var t=$(".topbar:first .active"),n=$(e.target);if((n=n.closest("button")).hasClass("pen")&&t.hasClass("pen"))ae();else{var o=$(e.target).closest("[data-tooltype]").data("tooltype");o&&function(e,t){m.disablePoint();var n=$(".toolbar button.active");if(0<n.length)switch(n.removeClass("active"),I){case"cursor":m.disableEdit();break;case"draw":m.disablePen();break;case"text":m.disableText();break;case"point":m.disablePoint();break;case"area":case"highlight":case"strikeout":case"underline":m.disableRect()}switch($(t).addClass("active"),I=e){case"cursor":m.enableEdit();break;case"draw":m.enablePen();break;case"text":m.enableText();break;case"point":$(".pdfViewer").css("cursor","crosshair"),m.enablePoint();break;case"area":case"highlight":case"strikeout":case"underline":m.enableRect(e)}}(o,e.target)}n.hasClass("comment")&&(W=!!n.hasClass("personal")&&"personal")}),function(a,s){a.on_annotation_comment_received=function(n){var e=$("#annotated-doc-conatiner");if(!(e.length<1)&&(e=e.is(":visible"))&&1==q&&e&&n.point.comment_doc_id==X){var t=l.attr("annotation-id");if(n.new_point){n.point.counter=1;var o=S();o.push(n.point),o=JSON.stringify(o),pe(p,p+"/annotations",o),m.renderPage(n.point.page,h,function(e,t){g.addComment(p,n.point.uuid,n.point.comment,1).then(function(e){c(e,1),D.find(".comment-list-item:last").css({background:"green",color:"white"})}),x(e,t),L(n.point,1,1)})}else n.point.uuid==t?(g.addComment(p,n.point.uuid,n.point.comment,1).then(function(e){c(e,1),D.find(".comment-list-item:last").css({background:"green",color:"white"})}),E(n.point)):(g.addComment(p,n.point.uuid,n.point.comment,1),L(n.point,1))}};var e=localStorage.getItem("user");function t(){if(a.should_save){ee=[],$(".active-mention a.mention").each(function(e,t){var n=$(t).attr("mentioned_id");-1==ee.indexOf(n)&&ee.push(parseInt(n))});var e=o.html();if(""!=(e=e.substr(0,e.length-1))){var t={date_time:new Date,user_name:R.name,uid:R.id,user_image:R.photo,content:e};if(!t.content)return!1;g.addComment(p,f,t).then(function(e){c(e,1)})}else o.html("")}else a.should_save=!0}function u(e){v=1,setTimeout(function(){e?V(e):(C(U),o.closest("form").hide())},11)}function d(e,t){var n=s.createElement("div");for(var o in n.classList.add("groupcomment"),e){var r=i(e[o]);n.appendChild(r)}$(n).attr("annotationId",t),l.append(n)}function n(e){l.html(""),e.forEach(c)}e=JSON.parse(e),$("body").on("keyup","#commentText",function(e){f?e.shiftKey||13!=e.keyCode||(e.preventDefault(),t()):console.log("Comment not added because, no active annotationId")}),$("body").on("click",".commentText1",function(e){t()});var r=!(oe=function(i){l.html(""),l.removeAttr("annotation-id"),$(".comment-list-container").addClass("full-discussion");var e=!1;"notes"==U&&(e="personal"),g.getPointAnnotations(p,e).then(function(n){(n=n.annotations).sort(function(e,t){return e.page-t.page||e.y-t.y||e.x-t.x});var e=-1,o=-1,r=n.length;for(var t in n)++e,g.getComments(p,n[e].uuid).then(function(e){var t=n[++o];d(e,t.uuid,t.sub_type),o+1==r&&u(i)});-1==e&&u(i)})});function i(e){var t=s.createElement("div");t.className="comment-list-item",e.date_time=a.dt_functions.standeredTime(e.date_time);var n=e.user_name,o="";if(e.user)if(n=e.user.name,e.user.image)o='<img class="img-fluid" id="navbar-profile-img" src="'+(o=a.site_config.server_base_url+e.user.image)+'">';else{var r=n.match(/\b\w/g)||[];o="<span>"+(r=((r.shift()||"")+(r.pop()||"")).toUpperCase())+"</span>"}var i="";return i+='<div class="user-pic-time-infoWrapper">',i+='<div class="userSmpic icon-user-single">',i+=+o,i+="</div>",i+='<div class="user-time-info pt-2">',i+='<span class="user text-primary">',i+=e.user_name+"</span>",i+='<span class="time small">',i+=a.dt_functions.timeAgo(e.date_time),i+="</div>",i+="</div>",i+='<div class="comment-details pt-1 pl-1">',i+="<p>"+e.content+"</p>",i+="</div>",$(t).attr("comment-id",e.uuid),$(t).attr("annotation",e.annotation),t.innerHTML=i,t}function c(e,t){var n=i(e);l.append(n),t&&k()}$("body").on("click","#comment-wrapper .buttons",function(e){e.preventDefault(),Y=!0,r=$(this).closest(".comment-list-item"),$(".update-comment:first").css({top:e.pageY,left:e.pageX}).show()}),$("body").on("click",".annotation_button.unread",function(){for(var e=$(".canvasWrapper .new_comments_count"),t=e.length,n=0;n<t;n++){var o=e.eq(n);if(0<parseInt(o.html())){V(o.attr("point_id"));break}}}),$("body").on("click",".update-comment:first .delete",function(e){var t=r.closest(".groupcomment"),n=r.attr("comment-id"),o=r.attr("annotation");g.deleteComment(p,o,n).then(function(){1==t.children(".comment-list-item").length?t.remove():r.remove(),Y=!1,$(".update-comment").hide()})}),$("body").on("click",".show-all-comments",function(){setTimeout(A,50)}),V=function(e){if(v){var t=void 0;if(t="string"==typeof e?e:e.attr("annotationId")){var a=$("svg.annotationLayer").find('svg[data-pdf-annotate-id="'+t+'"]');if(0<a.length){var s=$('.canvasWrapper .new_comments_count[point_id="'+t+'"]');setTimeout(function(){B.scrollTop(0);var e=s.closest(".canvasWrapper"),t=e.height()*(e.closest(".page").index()+1),n=s[0],o=parseFloat(n.style.top)-100,r=parseFloat(n.style.left)-100,i=t+o;B.scrollLeft(r),B.animate({scrollTop:i},500),K(a[0])},15)}else console.log(target,"Not found")}else console.log("Invalid point id")}else oe(e)},$("body").on("click","#comment-wrapper .groupcomment",function(e){$(e.target).is(".buttons")||V($(this))}),Q=function(u){g.getAnnotation(p,G).then(function(e){if(H=e,function(e){var t=e.getAttribute("data-pdf-annotate-type");return-1<["point"].indexOf(t)}(u))te(e);else{var t=$(".colors.ContextMenuPopup:first"),n=$(u).position(),o=$("#pdf-annotate-edit-overlay:visible").width(),r=t.width(),i=n.left+o/2-r/2,a=$(u).attr("fill");"none"!=(a=a||$(u).attr("stroke"))&&a||(a="#000000");var s=t.find('.row>.cell[hex="'+a+'"]');0==s.length?$("#applied_color").hide():s.append($("#applied_color").show()),t.css({left:i,top:n.top+30}).show(),Y=!0}})},te=function(t){f=G,g.getComments(p,G).then(n).then(function(){if(0<t.counter){var e=D.find(".comment-list-item").length;e=e-t.counter-1,D.find(".comment-list-item:gt("+e+")").css({background:"green",color:"white"}),E(t,t.counter)}}),H.sub_type?($(".comment-list-container").addClass("full-discussion"),l.removeAttr("annotation-id"),C("notes")):($(".comment-list-container").removeClass("full-discussion"),l.attr("annotation-id",G),$("#pdf-annotate-edit-overlay a").remove(),C("comments")),k()},Z=function(){H=!1};$(a).width(),$(a).height(),$(s).height();$("body").on("click",".toolbar:first .comment",function(){m.destroyEditOverlay(),U=$(this).is(".personal")?"notes":"comments",oe()}),m.addEventListener("annotation:click",K),m.addEventListener("annotation:blur",Z)}(window,document),t.render=P}catch(e){console.log(e)}var I,O,M,N;function j(e,t,n,o){if(0==e.length&&(e=S()),0!=e.length||0!=n.length){(e=(e=e.filter(function(e){return"point"!=e.type||e.sub_type})).concat(n)).forEach(function(e){e.class="Annotation"});var r="";Array.isArray(e)?(r=JSON.stringify(e),pe(p,p+"/annotations",r),le(p,t),ce(p),u(o)):bootbox.alert("invalid annotations")}else o&&o.first_time&&u(o)}function T(e){console.log(e)}},function(e,t,n){!function(){if(null==e)var e={};e.txt={}}()},function(e,n,t){var o,r,i;(function(e){"use strict";var t,l=void 0,b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};t=function(){return r={},n.m=o=[function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(1),i=(o=r)&&o.__esModule?o:{default:o};t.default=i.default,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var o=s(n(2)),r=s(n(8)),i=s(n(10)),a=s(n(28));function s(e){return e&&e.__esModule?e:{default:e}}t.default={StoreAdapter:o.default,LocalStoreAdapter:r.default,__storeAdapter:new o.default,getStoreAdapter:function(){return this.__storeAdapter},setStoreAdapter:function(e){this.__storeAdapter=e},UI:a.default,render:i.default,getAnnotations:function(e,t){var n;return(n=this.getStoreAdapter()).getAnnotations.apply(n,arguments)}},e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e};function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i,a=n(3),s=(i=a)&&i.__esModule?i:{default:i},u=n(4);var d=(o(c,[{key:"__getAnnotations",value:function(e,t){(0,s.default)("getAnnotations")}},{key:"getAnnotation",value:function(e,t){(0,s.default)("getAnnotation")}},{key:"getCommentAnnotations",value:function(e){(0,s.default)("getCommentAnnotations")}},{key:"getPointAnnotations",value:function(e,t){(0,s.default)("getPointAnnotations")}},{key:"__addAnnotation",value:function(e,t,n){(0,s.default)("addAnnotation")}},{key:"__editAnnotation",value:function(e,t,n){(0,s.default)("editAnnotation"),destroyEditOverlay()}},{key:"__deleteAnnotation",value:function(e,t){(0,s.default)("deleteAnnotation")}},{key:"getComments",value:function(e,t){(0,s.default)("getComments")}},{key:"getAllComments",value:function(e){(0,s.default)("getAllComments")}},{key:"__addComment",value:function(e,t,n){(0,s.default)("addComment")}},{key:"__editComment",value:function(e,t){(0,s.default)("editComment")}},{key:"__deleteComment",value:function(e,t,n){(0,s.default)("deleteComment")}},{key:"getAnnotations",get:function(){return this.__getAnnotations},set:function(n){this.__getAnnotations=function(t,e){return n.apply(void 0,arguments).then(function(e){return e.annotations&&e.annotations.forEach(function(e){e.documentId=t}),e})}}},{key:"addAnnotation",get:function(){return this.__addAnnotation},set:function(o){this.__addAnnotation=function(t,n,e){return o.apply(void 0,arguments).then(function(e){return(0,u.fireEvent)("annotation:add",t,n,e),e})}}},{key:"editAnnotation",get:function(){return this.__editAnnotation},set:function(o){this.__editAnnotation=function(t,n,e){return o.apply(void 0,arguments).then(function(e){return(0,u.fireEvent)("annotation:edit",t,n,e),e})}}},{key:"deleteAnnotation",get:function(){return this.__deleteAnnotation},set:function(e){this.__deleteAnnotation=function(t,n){return e.apply(void 0,arguments).then(function(e){return e&&(0,u.fireEvent)("annotation:delete",t,n),e})}}},{key:"addComment",get:function(){return this.__addComment},set:function(o){this.__addComment=function(t,n,e){return o.apply(void 0,arguments).then(function(e){return(0,u.fireEvent)("comment:add",t,n,e),e})}}},{key:"editComment",get:function(){return this.__editComment},set:function(e){this.__editComment=function(t,n){return e.apply(void 0,arguments).then(function(e){return e&&(0,u.fireEvent)("comment:edit",t,n),e})}}},{key:"deleteComment",get:function(){return this.__deleteComment},set:function(e){this.__deleteComment=function(t,n,o){return e.apply(void 0,arguments).then(function(e){return e&&(0,u.fireEvent)("comment:delete",t,n,o),e})}}}]),c);function c(){var t=this,n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),Object.keys(n).forEach(function(e){"function"==typeof n[e]&&"function"==typeof t[e]&&(t[e]=n[e])})}t.default=d,e.exports=t.default},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){throw new Error(e+" is not implemented")},e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.fireEvent=function(){s.emit.apply(s,arguments)},t.addEventListener=function(){s.on.apply(s,arguments)},t.removeEventListener=function(){s.removeListener.apply(s,arguments)};var o,r=n(5),i=(o=r)&&o.__esModule?o:{default:o},a=n(6);var s=new i.default,u=void 0;document.addEventListener("click",function(e){if($(".toolbar .cursor").hasClass("active")&&(0,a.findSVGAtPoint)(e.clientX,e.clientY)){var t=(0,a.findAnnotationAtPoint)(e.clientX,e.clientY);u&&u!==t&&s.emit("annotation:blur",u),t&&(s.emit("annotation:click",t),u=t)}})},function(e,t){function o(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function s(e){return"function"==typeof e}function u(e){return"object"===(void 0===e?"undefined":b(e))&&null!==e}function d(e){return void 0===e}((e.exports=o).EventEmitter=o).prototype._events=void 0,o.prototype._maxListeners=void 0,o.defaultMaxListeners=10,o.prototype.setMaxListeners=function(e){if(!function(e){return"number"==typeof e}(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},o.prototype.emit=function(e){var t,n,o,r,i,a;if(this._events||(this._events={}),"error"===e&&(!this._events.error||u(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(d(n=this._events[e]))return!1;if(s(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),n.apply(this,r)}else if(u(n))for(r=Array.prototype.slice.call(arguments,1),o=(a=n.slice()).length,i=0;i<o;i++)a[i].apply(this,r);return!0},o.prototype.on=o.prototype.addListener=function(e,t){var n;if(!s(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,s(t.listener)?t.listener:t),this._events[e]?u(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,u(this._events[e])&&!this._events[e].warned&&(n=d(this._maxListeners)?o.defaultMaxListeners:this._maxListeners)&&0<n&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},o.prototype.once=function(e,t){if(!s(t))throw TypeError("listener must be a function");var n=!1;function o(){this.removeListener(e,o),n||(n=!0,t.apply(this,arguments))}return o.listener=t,this.on(e,o),this},o.prototype.removeListener=function(e,t){var n,o,r,i;if(!s(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=(n=this._events[e]).length,o=-1,n===t||s(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(u(n)){for(i=r;0<i--;)if(n[i]===t||n[i].listener&&n[i].listener===t){o=i;break}if(o<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},o.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(s(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},o.prototype.listeners=function(e){return this._events&&this._events[e]?s(this._events[e])?[this._events[e]]:this._events[e].slice():[]},o.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(s(t))return 1;if(t)return t.length}return 0},o.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.BORDER_COLOR=void 0,t.findSVGContainer=function(e){var t=e;for(;(t=t.parentNode)&&t!==document;)if("SVG"===t.nodeName.toUpperCase()&&"true"===t.getAttribute("data-pdf-annotate-container"))return t;return null},t.findSVGAtPoint=v,t.findAnnotationAtPoint=function(e,t){var n=v(e,t);if(!n)return;for(var o=n.querySelectorAll("[data-pdf-annotate-type]"),r=0,i=o.length;r<i;r++){var a=o[r];if(s(e,t,u(a)))return a}return null},t.pointIntersectsRect=s,t.getOffsetAnnotationRect=u,t.getAnnotationRect=d,t.scaleUp=m,t.scaleDown=function(e,t){var n={},o=c(e).viewport;return Object.keys(t).forEach(function(e){n[e]=t[e]/o.scale}),n},t.getScroll=function(e){var t=0,n=0,o=e;for(;(o=o.parentNode)&&o!==document;)t+=o.scrollTop,n+=o.scrollLeft;return{scrollTop:t,scrollLeft:n}},t.getOffset=h,t.disableUserSelect=function(){a.parentNode||document.head.appendChild(a)},t.enableUserSelect=function(){a.parentNode&&a.parentNode.removeChild(a)},t.getMetadata=c;var o,r=n(7),i=(o=r)&&o.__esModule?o:{default:o};t.BORDER_COLOR="#00BFFF";var a=(0,i.default)({body:{"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"}});function v(e,t){for(var n=document.querySelectorAll('svg[data-pdf-annotate-container="true"]'),o=0,r=n.length;o<r;o++){var i=n[o];if(s(e,t,i.getBoundingClientRect()))return i}return null}function s(e,t,n){return t>=n.top&&t<=n.bottom&&e>=n.left&&e<=n.right}function u(e){var t=d(e),n=h(e),o=n.offsetLeft,r=n.offsetTop;return{top:t.top+r,left:t.left+o,right:t.right+o,bottom:t.bottom+r}}function d(e){var t=0,n=0,o=0,r=0,i=e.getBoundingClientRect();switch(e.nodeName.toLowerCase()){case"path":var a=void 0,s=void 0,u=void 0,d=void 0;e.getAttribute("d").replace(/Z/,"").split("M").splice(1).forEach(function(e){var t=e.split(" ").map(function(e){return parseInt(e,10)});(void 0===a||t[0]<a)&&(a=t[0]),(void 0===s||t[2]>s)&&(s=t[2]),(void 0===u||t[1]<u)&&(u=t[1]),(void 0===d||t[3]>d)&&(d=t[3])}),t=d-u,n=s-a,o=a,r=u;break;case"line":t=parseInt(e.getAttribute("y2"),10)-parseInt(e.getAttribute("y1"),10),n=parseInt(e.getAttribute("x2"),10)-parseInt(e.getAttribute("x1"),10),o=parseInt(e.getAttribute("x1"),10),r=parseInt(e.getAttribute("y1"),10),0===t&&(t+=16,r-=8);break;case"text":t=i.height,n=i.width,o=parseInt(e.getAttribute("x"),10),r=parseInt(e.getAttribute("y"),10)-t;break;case"g":var c=h(e),l=c.offsetLeft,f=c.offsetTop;t=i.height,n=i.width,o=i.left-l,r=i.top-f,"strikeout"===e.getAttribute("data-pdf-annotate-type")?(t+=16,r-=8):"underline"===e.getAttribute("data-pdf-annotate-type")&&(t+=16,r-=14);break;case"rect":case"svg":t=parseInt(e.getAttribute("height"),10),n=parseInt(e.getAttribute("width"),10),o=parseInt(e.getAttribute("x"),10),r=parseInt(e.getAttribute("y"),10)}var p={top:r,left:o,width:n,height:t,right:o+n,bottom:r+t};return["svg","g"].includes(e.nodeName.toLowerCase())||(p=m(v(i.left,i.top),p)),p}function m(e,t){var n={},o=c(e).viewport;return Object.keys(t).forEach(function(e){n[e]=t[e]*o.scale}),n}function h(e){for(var t=e;(t=t.parentNode)&&t!==document&&"SVG"!==t.nodeName.toUpperCase(););var n=t.getBoundingClientRect();return{offsetLeft:n.left,offsetTop:n.top}}function c(e){return{documentId:e.getAttribute("data-pdf-annotate-document"),pageNumber:parseInt(e.getAttribute("data-pdf-annotate-page"),10),viewport:JSON.parse(e.getAttribute("data-pdf-annotate-viewport"))}}a.setAttribute("data-pdf-annotate-user-select","true")},function(e,t){e.exports=function(t){var e=document.createElement("style"),n=Object.keys(t).map(function(e){return function(e,t){return e+" {\n"+function(t){return Object.keys(t).map(function(e){return function(e,t){isNaN(t)||0==t||(t+="px");return function(e){return e.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()})}(e)+": "+t+";"}(e,t[e])}).join("\n")}(t)+"\n}"}(e,t[e])}).join("\n");return e.setAttribute("type","text/css"),e.appendChild(document.createTextNode(n)),e}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var h=o(n(9));function o(e){return e&&e.__esModule?e:{default:e}}var r=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":b(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,o(n(2)).default),i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":b(t))&&"function"!=typeof t?e:t}(this,Object.getPrototypeOf(i).call(this,{getAnnotations:function(o,r){return new Promise(function(e,t){var n=g(o).filter(function(e){return e.page===r&&"Annotation"===e.class&&(e.uid==R.id||"point"==e.type&&!e.sub_type)});e({documentId:o,pageNumber:r,annotations:n})})},getCommentAnnotations:function(o,e){return new Promise(function(e,t){var n=g(o).filter(function(e){return"point"==e.type&&"Annotation"===e.class&&(e.uid==R.id||!e.sub_type)});e({documentId:o,annotations:n})})},getPointAnnotations:function(o,r){return new Promise(function(e,t){var n=g(o).filter(function(e){return r?"point"==e.type&&"Annotation"===e.class&&e.uid==R.id&&e.sub_type:"point"==e.type&&"Annotation"===e.class&&!e.sub_type});e({documentId:o,annotations:n})})},getCommentPoints:function(e){return this.getCommentAnnotations(e)},getNotePoints:function(e){return this.getCommentAnnotations(e,sub_type)},getAnnotation:function(e,t){return Promise.resolve(g(e)[s(e,t)])},addAnnotation:function(r,i,a){return new Promise(function(e,t){if("string"==typeof a.type)if(R.id)if(a.class="Annotation",a.uuid=(0,h.default)(),a.page=i,a.date_time=new Date,R.id){a.uid=R.id;var n=g(r);n.push(a),"drawing"==a.type&&(a.to_merge=1,F.push(a));var o="pooint"==a.type&&!a.sub_type;y(r,n,o),e(a)}else console.log("oops no user id");else bootbox.alert("No user Id given");else console.log("Invalid annotation",a)})},editAnnotation:function(o,r,i){return new Promise(function(e,t){var n=g(o);n[s(o,r)]=i,y(o,n),function(e,n,o){document.querySelectorAll('[data-pdf-annotate-id="'+e+'"]').forEach(function(e){var t=!1;switch(n){case"strikeout":case"underline":t="stroke";break;case"highlight":t="fill";break;case"drawing":-1==o.indexOf("#")&&(o="#"+o),$(e).attr("stroke",o),t="fill"}t&&$(e).attr(t,"#"+o)})}(r,i.type,i.color),e(i)})},deleteAnnotation:function(r,i){return new Promise(function(e,t){var n=s(r,i);if(-1<n){var o=g(r);o.splice(n,1),y(r,o)}e(!0)})},getComments:function(r,i){return new Promise(function(e,t){var n=g(r).filter(function(e){return e.uuid===i}),o=[];o=Array.isArray(n)&&0<n.length?n[0].comments:[],Array.isArray(o)||(o=[]),e(o)})},getAllComments:function(n){return new Promise(function(e,t){e(g(n).filter(function(e){return"point"===e.type}).sort(function(e,t){return e.page-t.page||e.y-t.y||e.x-t.x})||[])})},addComment:function(f,p,v,m){return new Promise(function(e,t){if(p){var n={class:"Comment",uuid:(0,h.default)(),point_id:p,content:v.content,uid:v.uid,user_name:v.user_name,user:{image:v.user_image},date_time:v.date_time},o=f.split("-"),r={doc_type:o[0],document_id:o[1],comment_doc_name:X},i=g(f),a={},s=-1;for(var u in i)if(i[u].uuid==p){var d=i[s=u];for(var c in d)"comments"!=c&&(a[c]=d[c]);break}if(-1<s){i[s].comments?i[s].comments.push(n):i[s].comments=[n],console.log(n),a.comment=n,a.doc_id=f,a.document_id=o[1],a.comment_doc_id=X,r.point=a,r.mentioned_list=ee;var l="personal"!=a.sub_type;if(l&&!m){dn_rpc_object({data:{args:{app:"documents",model:"CommentAnnotation",method:"save_comment"},params:r},no_loader:1,onSuccess:function(e){ee=[],console.log("comment saved")}}),setTimeout(function(){$(".comment-list-container:first").scrollTop(9999)},10)}y(f,i,l)}else console.log("Annotation not found "+p)}else console.log("Comment not added because, no active annotationId");e(n)})},editComment:function(r,i,a,s){return new Promise(function(e,t){for(var n=g(r),o=0;o<n.length;o++)a===n[o].annotation&&i===n[o].uuid&&(n[o].content=s);y(r,n,1),e(!0)})},deleteComment:function(a,e,s){return new Promise(function(e,t){g(a);for(var n=-1,o=g(a),r=0,i=o.length;r<i;r++)if(o[r].uuid===s){n=r;break}-1<n&&(o.splice(n,1),y(a,o,1)),e(!0)})}}))}function g(e){var t=fe(e,e+"/annotations");return t=t?JSON.parse(t):[]}t.default=r;var a=void 0;function y(e,t,n){var o="";Array.isArray(t)&&(o=JSON.stringify(t)),pe(e,e+"/annotations",o),n||(de(e),clearTimeout(a),a=setTimeout(function(){re()},3e4))}function s(e,t){for(var n=-1,o=g(e),r=0,i=o.length;r<i;r++)if(o[r].uuid===t){n=r;break}return n}e.exports=t.default},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return o.replace(n,r)};var n=/[xy]/g,o="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";function r(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(n,o,r){return new Promise(function(e,t){return n.innerHTML="",n.setAttribute("data-pdf-annotate-container",!0),n.setAttribute("data-pdf-annotate-viewport",JSON.stringify(o)),n.removeAttribute("data-pdf-annotate-document"),n.removeAttribute("data-pdf-annotate-page"),r?(n.setAttribute("data-pdf-annotate-document",r.documentId),n.setAttribute("data-pdf-annotate-page",r.pageNumber),Array.isArray(r.annotations)&&0!==r.annotations.length?(r.annotations.forEach(function(e){(0,i.default)(n,e,o)}),void e(n)):e(n)):e(n)})};o(n(1));var i=o(n(11));o(n(20));function o(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){n=n||JSON.parse(e.getAttribute("data-pdf-annotate-viewport"));var o=void 0;switch(t.type){case"area":case"highlight":o=(0,s.default)(t);break;case"strikeout":case"underline":o=(0,r.default)(t);break;case"point":o=(0,a.default)(t);break;case"textbox":o=(0,u.default)(t);break;case"drawing":o=(0,i.default)(t)}o&&(o.setAttribute("data-pdf-annotate-id",t.uuid),o.setAttribute("data-pdf-annotate-type",t.type),o.setAttribute("aria-hidden",!0),e.appendChild(function(e,t){var n=function(e){var t=void 0,n=void 0,o=e.rotation%360;o<0&&(o+=360);switch(o){case 0:t=n=0;break;case 90:t=0,n=e.width/e.scale*-1;break;case 180:t=e.width/e.scale*-1,n=e.height/e.scale*-1;break;case 270:t=e.height/e.scale*-1,n=0}return{x:t,y:n}}(t),o="scale("+t.scale+")";if(o+=" rotate("+t.rotation+")",o+=" translate("+n.x+", "+n.y+")",e.setAttribute("transform",o),!v&&"svg"===e.nodeName.toLowerCase()){e.setAttribute("x",parseInt(e.getAttribute("x"),10)*t.scale),e.setAttribute("y",parseInt(e.getAttribute("y"),10)*t.scale);var r=parseInt(e.getAttribute("x",10)),i=parseInt(e.getAttribute("y",10)),a=parseInt(e.getAttribute("width"),10),s=parseInt(e.getAttribute("height"),10),u=(e.querySelector("path"),[e]),d=e.querySelector("svg"),c=e.querySelector("path"),l=e.querySelector("rect"),f=e.querySelector("g");d&&u.push(d),c&&u.push(c),l&&u.push(l),f&&u.push(f);var p=t.rotation%360;switch(p<0&&(p+=360),p){case 90:e.setAttribute("x",t.width-i-a),e.setAttribute("y",r),d&&(d.setAttribute("x",1),d.setAttribute("y",0));break;case 180:e.setAttribute("x",t.width-r-a),e.setAttribute("y",t.height-i-s),d&&d.setAttribute("y",2);break;case 270:e.setAttribute("x",i),e.setAttribute("y",t.height-r-s),d&&(d.setAttribute("x",-1),d.setAttribute("y",0))}}return e}(o,n)));return o};o(n(12));var r=o(n(13)),i=o(n(16)),a=o(n(17)),s=o(n(18)),u=o(n(19));function o(e){return e&&e.__esModule?e:{default:e}}var v=/firefox/i.test(navigator.userAgent);e.exports=t.default},function(e,t){var u=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable;e.exports=Object.assign||function(e,t){for(var n,o,r=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),i=1;i<arguments.length;i++){for(var a in n=Object(arguments[i]))u.call(n,a)&&(r[a]=n[a]);if(Object.getOwnPropertySymbols){o=Object.getOwnPropertySymbols(n);for(var s=0;s<o.length;s++)d.call(n,o[s])&&(r[o[s]]=n[o[s]])}}return r}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var n=document.createElementNS("http://www.w3.org/2000/svg","g");return(0,o.default)(n,{stroke:(0,r.default)(e.color||"#f00"),strokeWidth:1}),e.rectangles.forEach(function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","line");(0,o.default)(t,{x1:e.x,y1:e.y,x2:e.x+e.width,y2:e.y}),n.appendChild(t)}),n};var o=i(n(14)),r=i(n(15));function i(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(t,n){Object.keys(n).forEach(function(e){t.setAttribute(r(e),n[e])})};var n=/[A-Z]/g,o=["viewBox"],r=function(e){return-1===o.indexOf(e)&&(e=e.replace(n,function(e){return"-"+e.toLowerCase()})),e};e.exports=t.default},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){n.test(e)&&(e="#"+e);return e};var n=/^([a-f0-9]{6}|[a-f0-9]{3})$/i;e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=[],n=document.createElementNS("http://www.w3.org/2000/svg","path"),o=0,r=e.lines.length;o<r;o++){var i=e.lines[o],a=e.lines[o+1];i&&3!=i.length&&a&&3!=a.length&&t.push("M"+i[0]+" "+i[1]+" "+a[0]+" "+a[1])}return(0,s.default)(n,{d:t.join(" ")+"Z",stroke:(0,u.default)(e.color||"#000"),strokeWidth:e.width||1,fill:"none"}),n};var s=o(n(14)),u=o(n(15));function o(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=document.createElementNS("http://www.w3.org/2000/svg","svg"),o=document.createElementNS("http://www.w3.org/2000/svg","rect"),r=document.createElementNS("http://www.w3.org/2000/svg","path");(0,i.default)(n,{width:a,height:a,x:0,y:.05*a*-1,viewBox:"0 0 1000 1000"}),(0,i.default)(o,{width:a,height:a,stroke:"#fff",fill:"#ff5"}),(0,i.default)(r,{d:s,strokeWidth:50,stroke:"#000",fill:"#fff"}),e.sub_type&&(0,i.default)(t,{width:28,height:25,x:e.x,y:e.y});if(e.sub_type){'<rect width="25" height="22" x="1.962286" y="1"',' style="fill:#ffff00;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-opacity:1" />',' <rect width="18.4" height="1.5012145" x="5.8" y="5"',' style="fill:#000000;fill-opacity:1;stroke:none" />',' <rect width="18" height="0.86" x="6" y="10"',' style="fill:#000000;fill-opacity:1;stroke:none" />',' <rect width="18.4" height="0.86" x="5.8" y="14"',' style="fill:#000000;fill-opacity:1;stroke:none" />',' <rect width="18" height="0.86" x="6" y="18"',' style="fill:#000000;fill-opacity:1;stroke:none" />',t.innerHTML='<rect width="25" height="22" x="1.962286" y="1" style="fill:#ffff00;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-opacity:1" /> <rect width="18.4" height="1.5012145" x="5.8" y="5" style="fill:#000000;fill-opacity:1;stroke:none" /> <rect width="18" height="0.86" x="6" y="10" style="fill:#000000;fill-opacity:1;stroke:none" /> <rect width="18.4" height="0.86" x="5.8" y="14" style="fill:#000000;fill-opacity:1;stroke:none" /> <rect width="18" height="0.86" x="6" y="18" style="fill:#000000;fill-opacity:1;stroke:none" />'}else(0,i.default)(t,{width:a,height:a,x:e.x,y:e.y}),n.appendChild(r),t.appendChild(o),t.appendChild(n);return t};var o,r=n(14),i=(o=r)&&o.__esModule?o:{default:o};var a=25,s="M499.968 214.336q-113.832 0 -212.877 38.781t-157.356 104.625 -58.311 142.29q0 62.496 39.897 119.133t112.437 97.929l48.546 27.9 -15.066 53.568q-13.392 50.778 -39.06 95.976 84.816 -35.154 153.45 -95.418l23.994 -21.204 31.806 3.348q38.502 4.464 72.54 4.464 113.832 0 212.877 -38.781t157.356 -104.625 58.311 -142.29 -58.311 -142.29 -157.356 -104.625 -212.877 -38.781z";e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"===b(Symbol.iterator)?function(e){return void 0===e?"undefined":b(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":void 0===e?"undefined":b(e)};t.default=function(e){{if("highlight"!==e.type){var t=s(e);return(0,r.default)(t,{stroke:(0,i.default)(e.color||"#f00"),fill:"none"}),t}var n=function(){var t=document.createElementNS("http://www.w3.org/2000/svg","g");return(0,r.default)(t,{fill:(0,i.default)(e.color||"#ff0"),fillOpacity:.2}),e.rectangles.forEach(function(e){t.appendChild(s(e))}),{v:t}}();if("object"===(void 0===n?"undefined":o(n)))return n.v}};var r=a(n(14)),i=a(n(15));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){var t=document.createElementNS("http://www.w3.org/2000/svg","rect");return(0,r.default)(t,{x:e.x,y:e.y,width:e.width,height:e.height}),t}e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","text");return(0,o.default)(t,{x:e.x,y:e.y+parseInt(e.size,10),fill:(0,r.default)(e.color||"#000"),fontSize:e.size}),t.innerHTML=e.content,t};var o=i(n(14)),r=i(n(15));function i(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(n){n=Array.isArray(n)?n:[],Object.keys(s).forEach(function(t){var e=s[t];n.filter(function(e){return e.type===t}).sort(e).forEach(function(e,t){return(0,o.default)(e,t+1)})})};var o=r(n(21));function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){return e.y<t.y?e.x-t.x:1}function a(e,t){return i(e.rectangles[0],t.rectangles[0])}(0,r(n(27)).default)();var s={highlight:a,strikeout:a,underline:a,drawing:function(e,t){var n=e.lines[0],o=t.lines[0];return i({x:n[0],y:n[1]},{x:o[0],y:o[1]})},textbox:i,point:i,area:i};e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1];switch(e.type){case"highlight":case"strikeout":case"underline":var n=e.rectangles,o=n[0],r=n[n.length-1];l=(0,u.default)("Begin "+e.type+" annotation "+t,e.uuid),(0,c.default)(l,o.x,o.y,e.page,!0),l=(0,u.default)("End "+e.type+" annotation "+t,e.uuid+"-end"),(0,c.default)(l,r.x+r.width,r.y,e.page,!1);break;case"textbox":case"point":var i="textbox"===e.type?" (content: "+e.content+")":"";l=(0,u.default)(e.type+" annotation "+t+i,e.uuid),(0,d.default)(l,e.x,e.y,e.page);break;case"drawing":case"area":var a=void 0!==e.x?e.x:e.lines[0][0],s=void 0!==e.y?e.y:e.lines[0][1];l=(0,u.default)("Unlabeled drawing",e.uuid),(0,d.default)(l,a,s,e.page)}};var u=o(n(22)),d=o(n(23)),c=o(n(24));o(n(25));function o(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=document.createElement("div"),o=document.createTextNode(e);return n.appendChild(o),n.setAttribute("id","pdf-annotate-screenreader-"+t),n.style.position="absolute",n.style.left="-10000px",n.style.top="auto",n.style.width="1px",n.style.height="1px",n.style.overflow="hidden",n},e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o){if((0,p.default)(e,t,n,o,!0))return!0;var r=document.querySelector('svg[data-pdf-annotate-page="'+o+'"]'),i=r.getBoundingClientRect(),a=[].concat(function(e){{if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}}(r.parentNode.querySelectorAll(".textLayer > div")));n=(0,v.scaleUp)(r,{y:n}).y+i.top,t=(0,v.scaleUp)(r,{x:t}).x+i.left;for(var s=0,u=a.length;s<u;s++){var d=a[s],c=d.getBoundingClientRect();if(n<=c.top)return d.parentNode.insertBefore(e,d),!0}var l=r.parentNode.querySelector(".textLayer");if(l){var f=l.getBoundingClientRect();if((0,v.pointIntersectsRect)(t,n,f))return l.appendChild(e),!0}return!1};var o,r=n(24),p=(o=r)&&o.__esModule?o:{default:o},v=n(6);e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o,r){var i=function(t,n,e){var o=document.querySelector('svg[data-pdf-annotate-page="'+e+'"]'),r=o.getBoundingClientRect();return n=(0,f.scaleUp)(o,{y:n}).y+r.top,t=(0,f.scaleUp)(o,{x:t}).x+r.left,[].concat(function(e){{if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}}(o.parentNode.querySelectorAll(".textLayer [data-canvas-width]"))).filter(function(e){return(0,f.pointIntersectsRect)(t,n,e.getBoundingClientRect())})[0]}(t=Math.max(t+2*(r?1:-1),0),n+2,o);if(!i)return!1;t+=2*(r?-1:1);var a=document.querySelector('svg[data-pdf-annotate-page="'+o+'"]'),s=(0,f.scaleDown)(a,{left:i.getBoundingClientRect().left}).left-a.getBoundingClientRect().left,u=i.cloneNode(!0),d=u.innerHTML.split(""),c=[];u.style.position="absolute",u.style.top="-10000px",u.style.left="-10000px",document.body.appendChild(u);for(;d.length;){if(">"===d[d.length-1])for(;d.length&&(c.unshift(d.pop()),"<"!==c[0]););u.innerHTML=d.join("");var l=(0,f.scaleDown)(a,{width:u.getBoundingClientRect().width}).width;if(s+l<=t)break;c.unshift(d.pop())}return i.innerHTML=d.join("")+e.outerHTML+c.join(""),u.parentNode.removeChild(u),!0};var f=n(6);e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,o,t){var n=void 0;n=Array.isArray(t)?Promise.resolve(t):r.default.getStoreAdapter().getComments(e,o);return n.then(function(e){var t=document.getElementById("pdf-annotate-screenreader-"+o);if(t){var n=document.createElement("ol");n.setAttribute("id","pdf-annotate-screenreader-comment-list-"+o),n.setAttribute("aria-label","Comments"),t.appendChild(n),e.forEach(i.default)}})};var r=o(n(1)),i=o(n(26));function o(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!e)return;var t=document.querySelector("#pdf-annotate-screenreader-"+e.annotation+" ol");if(t){var n=document.createElement("li");n.setAttribute("id","pdf-annotate-screenreader-comment-"+e.uuid),n.appendChild(document.createTextNode(""+e.content)),t.appendChild(n)}},e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){(0,a.addEventListener)("annotation:add",function(e,t,n){d(e,t,n.type)}),(0,a.addEventListener)("annotation:edit",function(e,t,n){d(e,n.page,n.type)}),(0,a.addEventListener)("annotation:delete",c),(0,a.addEventListener)("comment:add",l),(0,a.addEventListener)("comment:delete",f)};u(n(21));var o=u(n(20)),r=u(n(26)),i=u(n(25)),a=n(4),s=u(n(1));function u(e){return e&&e.__esModule?e:{default:e}}function d(t,e,n){s.default.getStoreAdapter().getAnnotations(t,e).then(function(e){return e.annotations.filter(function(e){return e.type===n})}).then(function(e){return e.forEach(function(e){c(t,e.uuid)}),e}).then(o.default)}function c(e,t){p("pdf-annotate-screenreader-"+t),p("pdf-annotate-screenreader-"+t+"-end")}function l(e,t,n){var o=document.querySelector("pdf-annotate-screenreader-comment-list-"+t);(o?Promise.resolve(!0):(0,i.default)(e,t,[]).then(function(){return o=document.querySelector("pdf-annotate-screenreader-comment-list-"+t),!0})).then(function(){(0,r.default)(n)})}function f(e,t){p("pdf-annotate-screenreader-comment-"+t)}function p(e){var t=document.getElementById(e);t&&t.parentNode.removeChild(t)}e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),r=n(29),i=n(30),a=n(31),s=n(32),u=n(33),d=n(34);t.default={addEventListener:o.addEventListener,removeEventListener:o.removeEventListener,fireEvent:o.fireEvent,disableEdit:r.disableEdit,enableEdit:r.enableEdit,destroyEditOverlay:r.destroyEditOverlay,disablePen:i.disablePen,enablePen:i.enablePen,setPen:i.setPen,disablePoint:a.disablePoint,enablePoint:a.enablePoint,disableRect:s.disableRect,enableRect:s.enableRect,disableText:u.disableText,enableText:u.enableText,setText:u.setText,createPage:d.createPage,renderPage:d.renderPage,renderPageWithoutAnnotations:d.renderPageWithoutAnnotations},e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var g=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);o=!0);}catch(e){r=!0,i=e}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};t.enableEdit=function(e){if(i)return;if(e)return void f(e);i=!0,(0,o.addEventListener)("annotation:click",K)},t.disableEdit=function(){if(p(),!i)return;i=!1,(0,o.removeEventListener)("annotation:click",K)},t.destroyEditOverlay=p;var y=r(n(1)),b=r(n(11)),o=n(4),_=n(6);function r(e){return e&&e.__esModule?e:{default:e}}function w(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var i=!1,s=!1,u=void 0,a=void 0,d=void 0,c=void 0,l=void 0,x=3;function f(e){p(),u=document.createElement("div");var t=document.createElement("a"),n=(0,_.findSVGContainer)(e).parentNode,o=e.getAttribute("data-pdf-annotate-id"),r=(0,_.getAnnotationRect)(e),i=r.left-x,a=r.top-x;u.setAttribute("id","pdf-annotate-edit-overlay"),u.setAttribute("data-target-id",o),u.style.boxSizing="content-box",u.style.position="absolute",u.style.top=a+"px",u.style.left=i+"px",u.style.width=r.width+"px",u.style.height=r.height+"px",u.style.border=x+"px solid "+_.BORDER_COLOR,u.style.borderRadius=x+"px",t.innerHTML="",t.setAttribute("href","javascript://"),t.style.background="#fff",t.style.borderRadius="20px",t.style.border="1px solid #bbb",t.style.color="#bbb",t.style.fontSize="16px",t.style.padding="2px",t.style.textAlign="center",t.style.textDecoration="none",t.style.position="absolute",t.style.top="-13px",t.style.right="-13px",t.style.width="25px",t.style.height="25px",u.appendChild(t),n.appendChild(u),document.addEventListener("click",m),document.addEventListener("keyup",h),document.addEventListener("mousedown",C),t.addEventListener("click",v),t.addEventListener("mouseover",function(){t.style.color="#35A4DC",t.style.borderColor="#999",t.style.boxShadow="0 1px 1px #ccc"}),t.addEventListener("mouseout",function(){t.style.color="#bbb",t.style.borderColor="#bbb",t.style.boxShadow=""}),u.addEventListener("mouseover",function(){s||(t.style.display="")}),u.addEventListener("mouseout",function(){t.style.display="none"})}function p(){u&&(u.parentNode.removeChild(u),u=null),document.removeEventListener("click",m),document.removeEventListener("keyup",h),document.removeEventListener("mousedown",C),document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",k),(0,_.enableUserSelect)()}function v(){if(u){var t=u.getAttribute("data-target-id"),e=document.querySelectorAll('[data-pdf-annotate-id="'+t+'"]'),n=u.parentNode.querySelector("svg.annotationLayer"),o=(0,_.getMetadata)(n).documentId,r=localStorage.getItem(o+"/annotations");if(r){var i=JSON.parse(r).filter(function(e){return e.uuid==t});if(0<i.length&&"point"==i[0].type&&!i[0].sub_type)return}[].concat(w(e)).forEach(function(e){e.parentNode.removeChild(e)}),y.default.getStoreAdapter().deleteAnnotation(o,t),p()}}function m(e){if((0,_.findSVGAtPoint)(e.clientX,e.clientY)){var t=document.getElementById("pdf-annotate-edit-overlay");if(t){if(s||e.target===t)return;p()}}}function h(e){u&&46===e.keyCode&&"textarea"!==e.target.nodeName.toLowerCase()&&"input"!==e.target.nodeName.toLowerCase()&&v()}var A=void 0;function C(e){if(e.target===u){var t=u.getAttribute("data-target-id"),n=document.querySelector('[data-pdf-annotate-id="'+t+'"]').getAttribute("data-pdf-annotate-type");if("highlight"!==n&&"strikeout"!==n&&"underline"!==n){s=!0,a=e.clientX,d=e.clientY,c=u.offsetLeft,l=u.offsetTop,u.style.background="rgba(255, 255, 255, 0.7)",u.style.cursor="move";var o=u.querySelector("a");o&&o.style&&(o.style.display="none"),document.addEventListener("mousemove",S),document.addEventListener("mouseup",k),(0,_.disableUserSelect)(),A=0!=(A=$('.new_comments_count[point_id="'+t+'"]')).length&&A[0]}}}function S(e){u.getAttribute("data-target-id");var t=u.parentNode.getBoundingClientRect(),n=l+(e.clientY-d),o=c+(e.clientX-a),r=t.height,i=t.width;0<n&&n+u.offsetHeight<r&&(u.style.top=n+"px",A&&(A.style.top=n-15+"px")),0<o&&o+u.offsetWidth<i&&(u.style.left=o+"px",A&&(A.style.left=o+20+"px"))}function k(e){var l=u.getAttribute("data-target-id"),f=document.querySelectorAll('[data-pdf-annotate-id="'+l+'"]'),p=f[0].getAttribute("data-pdf-annotate-type"),v=u.parentNode.querySelector("svg.annotationLayer"),m=(0,_.getMetadata)(v).documentId,t=u.querySelector("a");function h(e,t){return{deltaX:x+(0,_.scaleDown)(v,{x:u.offsetLeft}).x-e,deltaY:x+(0,_.scaleDown)(v,{y:u.offsetTop}).y-t}}t&&t.style&&(t.style.display=""),y.default.getStoreAdapter().getAnnotation(m,l).then(function(a){var e,t,n,o,r,i,s,u,d,c;-1<["area","highlight","point","textbox"].indexOf(p)?(u=function(e,t){return h(parseInt(f[0].getAttribute(e),10),parseInt(f[0].getAttribute(t),10))}("x","y"),d=u.deltaX,c=u.deltaY,[].concat(w(f)).forEach(function(e,t){if(0!==c){var n=parseInt(e.getAttribute("y"),10)+c,o=n;"textbox"===p&&(o+=a.size),"point"===p&&(o=(0,_.scaleUp)(v,{viewY:o}).viewY),e.setAttribute("y",o),a.rectangles?a.rectangles[t].y=n:a.y&&(a.y=n)}if(0!==d){var r=parseInt(e.getAttribute("x"),10)+d,i=r;"point"===p&&(i=(0,_.scaleUp)(v,{viewX:i}).viewX),e.setAttribute("x",i),a.rectangles?a.rectangles[t].x=r:a.x&&(a.x=r)}})):"drawing"===p&&(e=(0,_.scaleDown)(v,(0,_.getAnnotationRect)(f[0])),t=g(a.lines[0],2),n=t[0],o=t[1],r=h(n,o),i=r.deltaX,s=r.deltaY,s+=o-e.top,i+=n-e.left,a.lines.forEach(function(e,t){var n=g(a.lines[t],2),o=n[0],r=n[1];a.lines[t][0]=o+i,a.lines[t][1]=r+s}),f[0].parentNode.removeChild(f[0]),(0,b.default)(v,a)),y.default.getStoreAdapter().editAnnotation(m,l,a)}),setTimeout(function(){s=!1},0),u.style.background="",u.style.cursor="",document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",k),(0,_.enableUserSelect)()}K=function(e){setTimeout(function(){G=e.getAttribute("data-pdf-annotate-id"),f(e),Q(e)},15)}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.setPen=function(){var e=arguments.length<=0||void 0===arguments[0]?1:arguments[0],t=arguments.length<=1||void 0===arguments[1]?"000000":arguments[1];u=parseInt(e,10),d=t},t.enablePen=function(){if(r)return;is_mobile_device&&$("body").css("overflow","hidden");r=!0,document.addEventListener("mousedown",f),document.addEventListener("touchstart",f),(0,s.disableUserSelect)()},t.disablePen=function(){if(!r)return;r=!1,document.removeEventListener("mousedown",f),document.removeEventListener("touchstart",f),(0,s.enableUserSelect)()};var i=o(n(1)),a=o(n(11)),s=n(6);function o(e){return e&&e.__esModule?e:{default:e}}var r=!1,u=void 0,d=void 0,c=void 0,l=void 0;function f(e){is_mobile_device&&$("body").css("overflow","hidden"),c=null,l=[],document.addEventListener("mousemove",v),document.addEventListener("mouseup",p),document.addEventListener("touchmove",v,{passive:!1}),document.addEventListener("touchend",p)}function p(e){e.changedTouches&&(e=e.changedTouches[0]);var t=void 0;if(1<l.length&&(t=(0,s.findSVGAtPoint)(e.clientX,e.clientY))){var n=(0,s.getMetadata)(t),o=n.documentId,r=n.pageNumber;l[l.length-1].push(-1),i.default.getStoreAdapter().addAnnotation(o,r,{type:"drawing",width:u,color:d,lines:l}).then(function(e){c&&t.removeChild(c),(0,a.default)(t,e)})}document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",p),document.removeEventListener("touchmove",v),document.removeEventListener("touchend",p),is_mobile_device&&$("body").css("overflow","auto")}function v(e){e.preventDefault(),e.touches&&(e=e.touches[0]),function(e,t){var n=(0,s.findSVGAtPoint)(e,t);if(!n)return;var o=n.getBoundingClientRect(),r=(0,s.scaleDown)(n,{x:e-o.left,y:t-o.top});if(l.push([r.x,r.y]),l.length<=1)return;c&&n.removeChild(c);c=(0,a.default)(n,{type:"drawing",color:d,width:u,lines:l})}(e.clientX,e.clientY)}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"===b(Symbol.iterator)?function(e){return void 0===e?"undefined":b(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":void 0===e?"undefined":b(e)};t.enablePoint=function(){if(i)return;i=!0,document.addEventListener("mouseup",a)},t.disablePoint=function(){if(!i)return;i=!1,document.removeEventListener("mouseup",a)};var c=r(n(1)),l=r(n(11)),f=n(6);function r(e){return e&&e.__esModule?e:{default:e}}var i=!1,p=void 0;function a(e){!p&&(0,f.findSVGAtPoint)(e.clientX,e.clientY)&&((p=document.createElement("input")).setAttribute("id","pdf-annotate-point-input"),p.setAttribute("placeholder","Enter comment"),p.style.border="3px solid "+f.BORDER_COLOR,p.style.borderRadius="3px",p.style.position="fixed",p.style.top=e.clientY+"px",p.style.left=e.clientX+"px",p.addEventListener("blur",s),p.addEventListener("keyup",u),document.body.appendChild(p),p.focus())}function s(){d()}function u(e){27===e.keyCode?v():13===e.keyCode&&d()}function d(){if(0!=p.value.trim().length){if(0<p.value.trim().length){var e=function(){var e=parseInt(p.style.left,10),t=parseInt(p.style.top,10),i=p.value.trim(),a=(0,f.findSVGAtPoint)(e,t);if(!a)return{v:void 0};var n=a.getBoundingClientRect(),o=(0,f.getMetadata)(a),s=o.documentId,u=o.pageNumber,r=Object.assign({type:"point"},(0,f.scaleDown)(a,{x:e-n.left,y:t-n.top})),d=c.default.getStoreAdapter();r.sub_type=W,r.counter=0,d.addAnnotation(s,u,r).then(function(e){var t={content:i,date_time:new Date,uid:R.id,user_name:R.name,user_image:R.photo};d.addComment(s,e.uuid,t),(0,l.default)(a,e);var n=e.uuid,o=$("select.scale").val(),r="<div point_id="+e.uuid+' class="new_comments_count"';r+=' comment_count="0" style="'+("top:"+(e.y*o-15)+"px;")+("left:"+(e.x*o+15)+"px;")+';display:none;">0</div>',r=$(r),$("#pageContainer"+u+" .canvasWrapper").append(r),V(n)})}();if("object"===(void 0===e?"undefined":o(e)))return e.v}v()}else v()}function v(){p.removeEventListener("blur",s),p.removeEventListener("keyup",u),document.body.removeChild(p),p=null}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.enableRect=function(e){if(i=e,r)return;r=!0,document.addEventListener("mouseup",g),document.addEventListener("mousedown",d),document.addEventListener("keyup",m),g(e)},t.disableRect=function(){if(!r)return;r=!1,document.removeEventListener("mouseup",g),document.removeEventListener("mousedown",d),document.removeEventListener("keyup",m)};var c=o(n(1)),l=o(n(11)),f=n(6);function o(e){return e&&e.__esModule?e:{default:e}}function p(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var r=!1,i=void 0,a=void 0,s=void 0,u=void 0;function d(e){var t=void 0;if("area"===i&&(t=(0,f.findSVGAtPoint)(e.clientX,e.clientY))){var n=t.getBoundingClientRect();s=e.clientY,u=e.clientX,(a=document.createElement("div")).style.position="absolute",a.style.top=s-n.top+"px",a.style.left=u-n.left+"px",a.style.border="3px solid "+f.BORDER_COLOR,a.style.borderRadius="3px",t.parentNode.appendChild(a),document.addEventListener("mousemove",v),(0,f.disableUserSelect)()}}function v(e){var t=a.parentNode.querySelector("svg.annotationLayer").getBoundingClientRect();u+(e.clientX-u)<t.right&&(a.style.width=e.clientX-u+"px"),s+(e.clientY-s)<t.bottom&&(a.style.height=e.clientY-s+"px")}function m(e){27===e.keyCode&&(window.getSelection().removeAllRanges(),a&&a.parentNode&&(a.parentNode.removeChild(a),a=null,document.removeEventListener("mousemove",v)))}function h(n,e,t){var o=(0,f.findSVGAtPoint)(e[0].left,e[0].top),r=void 0;if(o){var i=o.getBoundingClientRect();if(t||("highlight"===n?t="FFFF00":"strikeout"===n?t="FF0000":"underline"===n&&(t="00FF00")),0!==(r={type:n,color:t,rectangles:[].concat(p(e)).map(function(e){var t=0;return"strikeout"===n?t=e.height/2:"underline"===n&&(t=e.height-2),(0,f.scaleDown)(o,{y:e.top+t-i.top,x:e.left-i.left,width:e.width,height:e.height})}).filter(function(e){return 0<e.width&&0<e.height&&-1<e.x&&-1<e.y})}).rectangles.length){if("area"===n){var a=r.rectangles[0];delete r.rectangles,r.x=a.x,r.y=a.y,r.width=a.width,r.height=a.height}var s=(0,f.getMetadata)(o),u=s.documentId,d=s.pageNumber;c.default.getStoreAdapter().addAnnotation(u,d,r).then(function(e){(0,l.default)(o,e)})}}}function g(e){if("string"==typeof e){var t=void 0;if("area"!==(i=e)&&(t=function(){try{var e=window.getSelection().getRangeAt(0).getClientRects();if(0<e.length&&0<e[0].width&&0<e[0].height)return e}catch(e){}return null}())){(0,f.findSVGAtPoint)(t[0].left,t[0].top);var n=p(t),o=(n=[].concat(n)).map(function(e){return{top:e.top,left:e.left,width:e.width,height:e.height}});h(i,o)}else if("area"===i&&a){var r=a.parentNode.querySelector("svg.annotationLayer").getBoundingClientRect();h(i,[{top:parseInt(a.style.top,10)+r.top,left:parseInt(a.style.left,10)+r.left,width:parseInt(a.style.width,10),height:parseInt(a.style.height,10)}]),a.parentNode.removeChild(a),a=null,document.removeEventListener("mousemove",v),(0,f.enableUserSelect)()}}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"===b(Symbol.iterator)?function(e){return void 0===e?"undefined":b(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":void 0===e?"undefined":b(e)};t.setText=function(){var e=arguments.length<=0||void 0===arguments[0]?12:arguments[0],t=arguments.length<=1||void 0===arguments[1]?"000000":arguments[1];f=parseInt(e,10),p=t},t.enableText=function(){if(i)return;i=!0,document.addEventListener("mouseup",a)},t.disableText=function(){if(!i)return;i=!1,document.removeEventListener("mouseup",a)};var u=r(n(1)),d=r(n(11)),c=n(6);function r(e){return e&&e.__esModule?e:{default:e}}var i=!1,l=void 0,f=void 0,p=void 0;function a(e){!l&&(0,c.findSVGAtPoint)(e.clientX,e.clientY)&&((l=document.createElement("input")).setAttribute("id","pdf-annotate-text-input"),l.setAttribute("placeholder","Enter text"),l.style.border="3px solid "+c.BORDER_COLOR,l.style.borderRadius="3px",l.style.position="absolute",l.style.top=e.clientY+"px",l.style.left=e.clientX+"px",l.style.fontSize=f+"px",l.addEventListener("blur",s),l.addEventListener("keyup",v),document.body.appendChild(l),l.focus())}function s(){m()}function v(e){27===e.keyCode?h():13===e.keyCode&&m()}function m(){if(0<l.value.trim().length){var e=function(){var e=parseInt(l.style.left,10),t=parseInt(l.style.top,10),n=(0,c.findSVGAtPoint)(e,t);if(!n)return{v:void 0};var o=(0,c.getMetadata)(n),r=o.documentId,i=o.pageNumber,a=n.getBoundingClientRect(),s=Object.assign({type:"textbox",size:f,color:p,content:l.value.trim()},(0,c.scaleDown)(n,{x:e-a.left,y:t-a.top,width:l.offsetWidth,height:l.offsetHeight}));u.default.getStoreAdapter().addAnnotation(r,i,s).then(function(e){(0,d.default)(n,e)})}();if("object"===(void 0===e?"undefined":o(e)))return e.v}h()}function h(){l&&(l.removeEventListener("blur",s),l.removeEventListener("keyup",v),document.body.removeChild(l),l=null)}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var m=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);o=!0);}catch(e){r=!0,i=e}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};t.createPage=function(e){var t=document.createElement("div");t.innerHTML=r;var n=t.children[0],o=n.querySelector("canvas");return n.setAttribute("id","pageContainer"+e),n.setAttribute("data-page-number",e),o.mozOpaque=!0,o.setAttribute("id","page"+e),n},t.renderPage=function(l,e,f){var t=e.documentId,n=e.pdfDocument,p=e.scale,v=e.rotate,o=n.getPage(l),r=h.default.getAnnotations(t,l),i=[o,r];return Promise.all(i).then(function(e){var t=m(e,2),n=t[0],i=t[1],a=document.getElementById("pageContainer"+l),o=a.querySelector(".annotationLayer"),r=a.querySelector(".canvasWrapper canvas").getContext("2d",{alpha:!1}),s=n.getViewport(p,v),u=y(l,s,r),d=n.render({canvasContext:r,viewport:s,transform:u}),c=h.default.render(o,s,i);return Promise.all([d,c]).then(function(){return n.getTextContent({normalizeWhitespace:!0}).then(function(r){return new Promise(function(e,t){var n=a.querySelector(".textLayer"),o=(new PDFJS.DefaultTextLayerFactory).createTextLayerBuilder(n,l-1,s);o.setTextContent(r),o.render(),setTimeout(function(){try{(0,g.default)(i.annotations),e()}catch(e){t(e)}})})})}).then(function(){return a.setAttribute("data-loaded","true"),f&&f(i.annotations,l),[n,i]})})},t.renderPageWithoutAnnotations=function(c,e,l){e.documentId;var t=e.pdfDocument,f=e.scale,p=e.rotate,n=[t.getPage(c),[]];return Promise.all(n).then(function(e){var t=m(e,2)[0],i=[],a=document.getElementById("pageContainer"+c),n=a.querySelector(".annotationLayer"),o=a.querySelector(".canvasWrapper canvas").getContext("2d",{alpha:!1}),s=t.getViewport(f,p),r=y(c,s,o),u=t.render({canvasContext:o,viewport:s,transform:r}),d=h.default.render(n,s,i);return Promise.all([u,d]).then(function(){return t.getTextContent({normalizeWhitespace:!0}).then(function(r){return new Promise(function(e,t){var n=a.querySelector(".textLayer"),o=(new PDFJS.DefaultTextLayerFactory).createTextLayerBuilder(n,c-1,s);o.setTextContent(r),o.render(),setTimeout(function(){try{(0,g.default)(i.annotations),l&&l(),e()}catch(e){t(e)}})})})}).then(function(){return a.setAttribute("data-loaded","true"),[t,i]})})};var h=o(n(1)),g=o(n(20));function o(e){return e&&e.__esModule?e:{default:e}}var r='\n  <div style="visibility: hidden;" class="page" data-loaded="false">\n    <div class="canvasWrapper">\n      <canvas></canvas>\n    </div>\n    <svg class="annotationLayer"></svg>\n    <div class="textLayer"></div>\n  </div>\n';function y(e,t,n){var o=document.getElementById("pageContainer"+e),r=o.querySelector(".canvasWrapper canvas"),i=o.querySelector(".annotationLayer"),a=o.querySelector(".canvasWrapper"),s=o.querySelector(".textLayer"),u=function(e){var t=window.devicePixelRatio||1,n=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1,o=t/n;return{sx:o,sy:o,scaled:1!=o}}(n),d=u.scaled?[u.sx,0,0,u.sy,0,0]:null,c=f(u.sx),l=f(u.sy);return o.style.visibility="",r.width=p(t.width*u.sx,c[0]),r.height=p(t.height*u.sy,l[0]),r.style.width=p(t.width,c[1])+"px",r.style.height=p(t.height,c[1])+"px",i.setAttribute("width",t.width),i.setAttribute("height",t.height),i.style.width=t.width+"px",i.style.height=t.height+"px",o.style.width="100%",o.style.height=t.height+"px",a.style.width=t.width+"px",a.style.height=t.height+"px",s.style.width="100%",s.style.height=t.height+"px",$("#viewer").width(t.width),d}function f(e){if(Math.floor(e)===e)return[e,1];var t=1/e;if(8<t)return[1,8];if(Math.floor(t)===t)return[1,t];for(var n=1<e?t:e,o=0,r=1,i=1,a=1;;){var s=o+i,u=r+a;if(8<u)break;n<=s/u?(i=s,a=u):(o=s,r=u)}return n-o/r<i/a-n?n===e?[o,r]:[r,o]:n===e?[i,a]:[a,i]}function p(e,t){var n=e%t;return 0==n?e:Math.round(e-n+t)}}],n.c=r,n.p="",n(0);function n(e){if(r[e])return r[e].exports;var t=r[e]={exports:{},id:e,loaded:!1};return o[e].call(t.exports,t,t.exports,n),t.loaded=!0,t.exports}var o,r},"object"===b(n)&&"object"===b(e)?e.exports=t():(r=[],void 0===(i="function"==typeof(o=t)?o.apply(n,r):o)||(e.exports=i))}).call(n,t(3)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){function n(e,t){var n=arguments.length<=1||void 0===t||t;e,d.setAttribute("data-color",e),d.style.background=e,n&&"function"==typeof o&&o(e),r()}function r(){document.removeEventListener("keyup",a),s&&s.parentNode&&s.parentNode.removeChild(s),u=!1,d.focus()}function i(e){var t=document.createElement("a");return t.className="color",t.setAttribute("href","javascript://"),t.setAttribute("title",e.name),t.setAttribute("data-color",e.hex),t.style.background=e.hex,t}function a(e){27===e.keyCode&&r()}var s=void 0,u=!1,d=i({hex:t});d.onclick=function(){u?r():function(){s||((s=document.createElement("div")).style.background="#fff",s.style.border="1px solid #ccc",s.style.padding="2px",s.style.position="absolute",s.style.width="122px",e.style.position="relative",c.map(i).forEach(function(e){e.style.margin="2px",e.onclick=function(){n(e.getAttribute("data-color"))},s.appendChild(e)}));document.addEventListener("keyup",a),e.appendChild(s),u=!0}()},n(t,!1)};var c=[{hex:"#000000",name:"Black"},{hex:"#EF4437",name:"Red"},{hex:"#E71F63",name:"Pink"},{hex:"#8F3E97",name:"Purple"},{hex:"#65499D",name:"Deep Purple"},{hex:"#4554A4",name:"Indigo"},{hex:"#2083C5",name:"Blue"},{hex:"#35A4DC",name:"Light Blue"},{hex:"#09BCD3",name:"Cyan"},{hex:"#009688",name:"Teal"},{hex:"#43A047",name:"Green"},{hex:"#8BC34A",name:"Light Green"},{hex:"#FDC010",name:"Yellow"},{hex:"#F8971C",name:"Orange"},{hex:"#F0592B",name:"Deep Orange"},{hex:"#F06291",name:"Light Pink"}]}],i.c=o,i.p="",i(0));function i(e){if(o[e])return o[e].exports;var t=o[e]={exports:{},id:e,loaded:!1};return n[e].call(t.exports,t,t.exports,i),t.loaded=!0,t.exports}window.pdf_js_module=e}();